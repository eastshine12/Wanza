<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
  

  
<mapper namespace="com.decolab.wanza.dao.CardDAO">


  
<select id="getCardList" resultType="com.decolab.wanza.dto.CardDTO">
	SELECT CARDSEQ, CARDTITLE, CARDCONTENT, USERSEQ, CARDREADCOUNT, CARDDATE, CARDFILENAME, CARDDEL
	FROM CARD_COLLECTIONS
</select>
  
  
<insert id="cardWrite" parameterType="com.decolab.wanza.dto.CardDTO">
	INSERT INTO CARD_COLLECTIONS
	VALUES (SEQ_CARD.NEXTVAL, #{cardTitle}, #{cardContent}, #{userSeq}, 0, SYSDATE, #{cardFileName}, 0)
</insert>
  
  
  
  
  
<!-- 리뷰 가져온다 -->
<select id="getCardReviewList" parameterType="com.decolab.wanza.dto.CardReviewDTO" resultType="com.decolab.wanza.dto.CardReviewDTO">
	SELECT CARDREVSEQ, CARDSEQ, NICKNAME, CARDREVCONTENT, CARDREVDATE, CARDREVDEL
	FROM (SELECT ROW_NUMBER()OVER(ORDER BY CARDREVSEQ DESC) AS RNUM, CARDREVSEQ, CARDSEQ, NICKNAME, CARDREVCONTENT, CARDREVDATE, CARDREVDEL FROM CARD_REVIEW)	
	WHERE CARDSEQ=#{cardSeq} AND RNUM&gt;=1+4*#{cardRevPageNum} AND RNUM&lt;=4+4*#{cardRevPageNum}
</select>  

<!-- 리뷰 총 개수 -->
<select id="getCardReviewList" parameterType="com.decolab.wanza.dto.CardReviewDTO" resultType="com.decolab.wanza.dto.CardReviewDTO">
	SELECT NVL(COUNT(*), 0)
	FROM CARD_REVIEW
	WHERE CARDSEQ=#{cardSeq} AND CARDREVDEL = 0
</select>
  
  
  
  
</mapper>