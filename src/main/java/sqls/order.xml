<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
  

  
<mapper namespace="com.decolab.wanza.dao.OrderDAO">

<!-- 장바구니 추가 -->
<insert id="addCart" parameterType="com.decolab.wanza.dto.CartDTO">
	INSERT INTO CART
	VALUES (#{cartClassify}, #{userSeq}, #{productSeq}, #{selectOption}, #{quantity}, #{price}, SYSDATE, 0)
</insert>


<!-- 장바구니에 이미 담겨있는지 확인 -->
<select id="checkCart" parameterType="com.decolab.wanza.dto.CartDTO" resultType="int">
	SELECT NVL(COUNT(*),0)
	FROM CART
	WHERE PRODUCTSEQ=#{productSeq} AND CARTSTATUS IN (0,1)
</select>


<!-- 유저별 장바구니 리스트 가져오기 -->
<select id="getCartList" resultType="com.decolab.wanza.dto.CartDTO">
	SELECT CARTCLASSIFY, C.USERSEQ, C.PRODUCTSEQ, SELECTOPTION, QUANTITY, PRICE, CARTDATE, CARTSTATUS,
        P.PRODUCTNAME, P.PRODUCTMAKER, P.PRODUCTFILENAME
	FROM CART C, PRODUCTIONS P
	WHERE C.PRODUCTSEQ=P.PRODUCTSEQ AND CARTCLASSIFY=#{cartClassify} AND CARTSTATUS IN (0,1)
	ORDER BY CARTDATE ASC
</select>


<!-- 장바구니 아이템 삭제 -->
<delete id="deleteCart" parameterType="com.decolab.wanza.dto.CartDTO">
	DELETE FROM CART
	WHERE CARTCLASSIFY=#{cartClassify} AND PRODUCTSEQ=#{productSeq}
</delete>


<!-- 장바구니 분류번호 1 변경  -->
<update id="checkedCart" parameterType="com.decolab.wanza.dto.CartDTO">
	UPDATE CART
	SET CARTSTATUS=1
	WHERE CARTCLASSIFY=#{cartClassify} AND PRODUCTSEQ=#{productSeq}
</update>



</mapper>