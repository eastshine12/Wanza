<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>완벽한 자취생활, 완자</title>

<link rel="shortcut icon" href="../../assets/img/wanza-Icon.ico" type="image/x-icon"> <!-- 브라우저 탭 아이콘 -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css"> <!-- 폰트어썸아이콘 -->
<!-- <link rel="stylesheet" type="text/css" href="../../assets/bootstrap/css/bootstrap.min.css"> -->
<!-- 부트스트랩 -->
<link rel="stylesheet" type="text/css" href="../../css/style.css"> <!-- 공통-->

<style>
/* html {scroll-behavior: smooth;} */
/* 맨 위에 상자 */
.top_slider{
    display: none;
    visibility: hidden;
    height: 500px;
    margin: 60px 0 0 0;
}
/* 캐로셀, 슬라이드 */
#store_carousel{
    height: 420px;
    padding: 0 00px 0 0;
}
#store_carousel .carousel-inner{
    height: 100%;
    padding: 5px;
}
#store_carousel .carousel-item{
    min-width: 535px;
    position: relative;
    overflow: hidden;
    padding-bottom: 56.66667%;
    border-radius: 5px;
}
#store_carousel .carousel-item img{
    position: absolute;
    height: 100%;
    top: 50%; left: 50%;
    transform: translate(-50%, -50%);
}
#store_carousel .carousel-indicators{
    bottom: -10px;
}
#store_carousel .carousel-indicators li{
    height: 7px;
}
/* 위쪽 태그상자 */
.main_tag{
    height: 410px;
    padding: 0 0 0 20px; 
}
.tag_div{
    height: 100%;
    border-radius: 5px;
    background-color: #FFE8E1;
    margin: 5px 0;
    padding: 40px;
}
.tag_head span{
    font-size: 20pt;
    font-weight: 700;
}
.tag{
    display: inline-block;
    height: 40px;
    line-height: 38px;
    margin: 20px 0;
    padding: 0 8px;
    border: solid 1px #f4744c;
    border-radius: 18px;
    background-color: #f4744c;
    color: white;
    font-size: 12pt;
    text-decoration: none;
}
.tag a, .tag a:hover{
    color: white;
    text-decoration: none;
}

/* 아래 메인 */
#store_items{
    min-height: 1000px;
    /* height: 800px; */
    /* margin: 20px 0 0 0; */
    /* margin-top: 50px; */
}
#store_items a:hover{
    color: #424242;
    text-decoration: none;
}
#store_items a{
    color: #aeaeae;
}
/* 메인 카테고리 나열 */
.store_head{
    display: flex;
    position: relative;
    height: 100px;
    margin: 60px 10px 30px;
    padding: 30px 10px;
    /* border-top: solid 3px #dbdbdb; */
}
.store_head span{
    font-size: 2em;
    font-weight: 900;
    min-width: 91px;
}
.subtitle{
    position: absolute;
    width: 100px;
    top: 85px;
    left: 27px;
    color: #424242;
    text-align: right;
    font-size: 0.5em;
    font-weight: 700;
}
.store_head .store_subcategory{
    min-width: 650px;
    display: flex;
    list-style: none;
    align-items: center;
    font-size: 1em;
    padding: 0;
    margin: 0 0 0 15px;
    color: #aeaeae;
    cursor: pointer;
}
.store_subcategory>li{
    margin: 0 15px;
    display: inherit;
    position: relative;
}
.store_thirdcategor:hover,
.store_subcategory>li:hover .store_thirdcategory{
    display: flex;
}
.store_subcategory li.active,
.store_subcategory li:hover{
    color: #424242;
    /* font-weight: bold; */
}
.store_subcategory div{
    height: 50%;
    border: solid 1px #aeaeae;
    background-color: #aeaeae;
}
.store_thirdcategory{
    display: none;
    position: absolute;
    line-height: 40px;
    top: 20px; left: 0;
    width: 1000%;
    list-style: none;
    align-items: center;
    font-size: 1em;
    padding: 0;
    color: #aeaeae;
    cursor: pointer;
}
.store_thirdcategory>li{
    margin: 0 30px 0 0;
    display: inherit;
}


/* 정렬버튼 */
.right_wrap{
    display: flex;
    /* width: 32%; */
    justify-content: flex-end;
}
.pop_wrap{
    margin: 0;
    width: 130px;
    height: 40px;
}
.btn_pop{   /* 제목 버튼 */
    display: flex;
    position: relative;
    width: 100%; height: 100%;
    margin-bottom: 1PX;
    border: solid 0.5px #757575;
    border-radius: 4px;
    color: #424242;
    background-color: white;
    justify-content: space-between;
    align-items: center;
    z-index: 10;
}
.btn_pop.change{
    justify-content: start;
}
.pop_box{
    position: relative;
    overflow: hidden;
    margin-top: -0.1px;
    margin-left: -19px;
    padding: 0px 16px 0px 16px;
    width: 130%;
    height: 0px;
    z-index: 3;
    opacity: 0;
    transition: height .3s, opacity .3s;
    /* transition: all .3s; */
}
.pop_box:hover,
.btn_pop:hover+.pop_box{     /* 마우스 이벤트 */
    opacity: 1;
    height: auto;
    padding: 13px 16px 16px 16px;
    transition: all .3s;
}
.pop_content{   /* 내용박스 */
    position: relative;
    border-radius: 4px;
    background-color: white;
    z-index: 3;
    box-shadow: 0 -1px 16px rgb(0 0 0 / 20%);
}
.pop_content::before{   /* 박스 위 꼬다리 */
    content: "";
    position: absolute;
    background: white;
    z-index: -1;
    width: 15px; height: 15px;
    top: -8px; left: 40%;
    transform: rotate(45deg);
}
.pop_content.active::before{
    background: wheat;
}
.sub_content_ul{
    list-style: none;
    margin: 0; padding: 0;
}
.btn_subpop{    /* 세부내용 버튼 */
    width: 100%;
    height: 100%;
    border: none;
    color: #424242;
    background-color: white;
    padding: 15px;
    text-align: left;
}
.sub_content_ul li:first-of-type .btn_subpop{
    border-top-left-radius: 4px;
    border-top-right-radius: 4px;
}
.sub_content_ul li:last-of-type .btn_subpop{
    border-bottom-left-radius: 4px;
    border-bottom-right-radius: 4px;
}
.btn_subpop:hover{
    background-color: wheat;
}
/* 상품리스트 */
.store_main_head{
    display: none;
    height: 100px;
    margin: 0 10px 30px;
    padding: 40px 10px;
    border-top: solid 3px #dbdbdb;
}
.store_main_head h1{
    font-size: 30px;
    margin-bottom: 50px;
}
#hotProductList{
    margin: 0 0 0 30px;
    /* justify-content: center; */
    
}
/* 상품 리스트 페이징 */
.store_page{
    margin: 20px 0 100px;
}
#store_items .pagination{
    justify-content: center;
}
#store_items .page-item.active .page-link{
    background-color: #f4744c;
    border-color: #f4744c;
    color: white;
}
#store_items .page-link:focus{
    box-shadow: none;
}

.del_icon {
    color: rgb(255, 92, 92);
    display: flex;
    justify-content:flex-end;
    margin-right:30px; 
    
}
.fa.fa-minus-circle.fa-lg{
    cursor: pointer;
}
.fa.fa-minus-circle.fa-lg:hover {
    color: rgb(255, 173, 173);
}


</style>

</head>
<body>
    <header include-html="../commons/header.html"></header>
    <nav include-html="../commons/menuStore.html"></nav>

<!-- 맨위 슬라이더 -->
<div class="container top_slider">
    <div class="row">

        <div class="carousel slide col-md-8" id="store_carousel" data-ride="carousel">
            <div class="carousel-inner">
                
                <div class="carousel-item active">
                    <img src="../../assets/img/store_slide_001.png" alt="Slide Image">
                </div>
                <div class="carousel-item">
                    <img src="../../assets/img/store_slide_002.png" alt="Slide Image">
                </div>

            </div>

            <ol class="carousel-indicators">
                <li data-target="#store_carousel" data-slide-to="0" class="active"></li>
                <li data-target="#store_carousel" data-slide-to="1"></li>
            </ol>

        </div> <!-- 캐로셀 끝 -->

        <!-- 추천태그 -->
        <div class="col-md-4 main_tag">
            <div class="tag_div">
                <div class="tag_head"><span>추천태그</span></div>
                <div class="row mt-4 pr-4">
                    <div class="col-6 px-1"><span id="hashTag_1" class="tag" style="cursor: pointer;">#</span></div>
                    <div class="col-6 px-1"><span id="hashTag_2" class="tag" style="cursor: pointer;">#</span></div>
                    <div class="col-6 px-1"><span id="hashTag_3" class="tag" style="cursor: pointer;">#</span></div>
                    <div class="col-6 px-1"><span id="hashTag_4" class="tag" style="cursor: pointer;">#</span></div>
                    <div class="col-6 px-1"><span id="hashTag_5" class="tag" style="cursor: pointer;">#</span></div>
                    <div class="col-6 px-1"><span id="hashTag_6" class="tag" style="cursor: pointer;">#</span></div>
                </div>
            </div>
        </div>

    </div> <!-- 로우 끝 -->
</div> <!-- 슬라이더 상자 끝 -->

<!-- 상품파트 -->
<div class="container mb-5" id="store_items">
    
    <div class="store_head">
        <span></span>
        <!-- <div class="subtitle"><span>가구</span></div> -->
        <ul class="store_subcategory">
            <!-- 세부 카테고리가 들어가는 곳 -->
        </ul>
        
        <div class="col right_wrap"> <!-- 오른쪽 정렬 -->
            <div class="pop_wrap">
                <button type="button" class="btn_pop" value="sort=0">인기순 <i class="fas fa-sort"></i></button>
                
                <div class="pop_box">
                    <div class="pop_content">
                        <ul class="sub_content_ul">
                            <li><button type="button" class="btn_subpop" value="sort=1">평점순</button></li>
                            <li><button type="button" class="btn_subpop" value="sort=2">최신순</button></li>
                            <li><button type="button" class="btn_subpop" value="sort=3">판매순</button></li>
                        </ul>
                    </div>
                </div>

            </div> <!-- 인기순 버튼 -->
        </div>  <!-- 오른쪽 정렬 -->
    </div>

    <div class="store_main_head" id="today_hot">
        <h1><strong>오늘의 인기상품</strong></h1>
    </div>

    <div class="store_main">
        <div id="hotProductList" class="row">
        
            <!-- 상품 리스트 생성되는 곳 -->
        </div>
    </div>
    
    <div class="store_page">
        <!-- 상품리스트 페이지 번호 -->
    </div>
</div>



    <footer include-html="../commons/footer.html"></footer>

</body>

<script src="../../assets/js/jquery.min.js"></script>
<script src="../../assets/bootstrap/js/bootstrap.min.js"></script>
<script src="../../js/includeHTML.js"></script>
<script src="../../js/header.js"></script>
<script src="../../js/slang.js"></script>

<script src="../../js/jquery.twbsPagination.min.js"></script>

<script>
$(document).ready(function() {
    const category = getParameter("category")
    const subCategory = getParameter("subCategory")
    const downCategory = getParameter("downCategory")
    const searchWord = getParameter("searchWord")

    if(category=='' || category==null){
        $('.top_slider, .store_main_head, .submenu_wrap').show();
        $('.top_slider').css('visibility','visible');
        getProductSortList(setPdata(0));
        //getProductSortCount(setPdata(3)); //페이징
        $('.store_head').hide();
    }else{
        $('.store_head span').text(category);
        setCategory(category);
        //getProductSortList(setPdata(3));
        $('.store_head').show();
        getProductSortCount(setPdata(3)); //페이징
    }
    moveHotmenu('#today_hot') //인기상품 이동
    
    if(subCategory!='' && subCategory!=null){
        $('.store_subcategory li').removeClass('active')
        $('.store_subcategory>li').eq(subCategory).addClass('active')
        //getProductSortList(setPdata(3)) //인기순:최근3일판매량
        getProductSortCount(setPdata(3));
    }

    if(searchWord!=null){
        // $('').val(searchWord);
        // $('.store_subcategory li').removeClass('active')
        // $('.store_subcategory>li').eq(subCategory).addClass('active')
        // //getProductSortList(setPdata(3)) //인기순:최근3일판매량
        // getProductSortCount(setPdata(3));
    }
    
    // 분류 클릭 링크를 통해 넘어온 경우
    if(downCategory!='' && downCategory!=null) {
        goCategory(downCategory);
    }

    $('.sub_content_ul li:first-of-type .btn_subpop').hover( function() { // 인기순 메뉴 호버시 색
        $('.pop_content').toggleClass('active')
    });

    $('#navcol-2 .nav_a').click(function(){//인기상품 이동
        $('.store_head').hide();
        $('.top_slider, .store_main_head').show();
        moveHotmenu('#today_hot')
    });

    $(document).on('click','.store_subcategory>li',function(e){ //중분류 뿌리기
        //$('.store_thirdcategory').hide();
        $('.store_subcategory li').removeClass('active')
        console.log($('.store_subcategory li').eq(1).html())
        $(this).addClass('active')
        //$(this).addClass('active').children().css('display','flex');
        //getProductSortList(setPdata(3)) //인기순:최근3일판매량
        getProductSortCount(setPdata(3)); //페이징
    });

    $(document).on('click','.store_thirdcategory>li',function(e){ //소분류 뿌리기
        $('.store_subcategory li').removeClass('active')
        $('.store_thirdcategory>li').removeClass('active')
        $(this).addClass('active').parent().parent().addClass('active')
        //$('.store_thirdcategory>li').removeClass('active').parent().hide();
        //$(this).addClass('active').parent().parent().addClass('active')
        //$(this).parent().css('display','flex');
        //$(this).parent().parent().addClass('active')

        //getProductSortList(setPdata(3)) //인기순:최근3일판매량
        getProductSortCount(setPdata(3)); //페이징
        e.stopPropagation(); //다른 상 하위 요소 이벤트 막기
    });

    $('.btn_subpop').click(function(){ //순서정렬 버튼 바꾸기
        let title_text = $(this).text();
        let title_val = $(this).val();
        $('.btn_pop').html(title_text+' <i class="fas fa-sort"></i>').val(title_val);
        setSortBtn(title_text)
        //getProductSortList(setPdata(3))
        getProductSortCount(setPdata(3)); //페이징
    });

});

//파라미터값 가져오도록 하는 함수
function getParameter(name) {
    name = name.replace(/[\[]/, "\\[").replace(/[\]]/, "\\]");
    var regex = new RegExp("[\\?&]" + name + "=([^&#]*)"),
        results = regex.exec(location.search);
    return results === null ? "" : decodeURIComponent(results[1].replace(/\+/g, " "));
}

//로그인한 계정 닉네임 가져오기
let sessionId = JSON.parse(sessionStorage.getItem("login"));
if(sessionId == null) {
    sessionId = '';
};

// 금액 콤마 삽입 정규식
function makeComma(str) {
    str = String(str);
    return str.replace(/(\d)(?=(?:\d{3})+(?!\d))/g, '$1,');
};

//할인 퍼센테이지 계산
function discountRate(price, discount) {
    return Math.ceil(100- (discount/price*100));
};


//storeDetail에서 분류 클릭 시 이동해옴
function goCategory(downCategory) { 
    let targetTag;
    //targetTag = $('.store_subcategory>li:contains("'+downCategory+'")');
    
    $('.store_subcategory>li').each(function() {
        if($(this).attr('class') == downCategory) {
            targetTag = $(this);
            targetTag.addClass('active');
            return false;
        }
    });
    
    
    $('.store_thirdcategory>li').each(function() {
        let text = $(this).text();
        if(text == downCategory) {
            targetTag = $(this);
            targetTag.addClass('active').parent().parent().addClass('active');
            return false;
        }
    });
    //getProductSortList(setPdata(3)) //인기순:최근3일판매량
    getProductSortCount(setPdata(3)); //페이징
}

//카테고리 리스트 저장
function setCategory(param) {
    let furniture = '<li class="active">전체</li><div></div><li class="침대/매트리스">침대/매트리스'
                   +'<ul class="store_thirdcategory"><li>침대</li><li>매트리스</li><li>토퍼</li></ul>'
                   +'</li><div></div><li class="소파">소파</li><div></div><li class="테이블">테이블'
                   +'<ul class="store_thirdcategory"><li>식탁</li><li>좌식테이블</li><li>사이드테이블</li></ul>'
                   +'</li><div></div><li class="화장대/거울">화장대/거울'
                   +'<ul class="store_thirdcategory"><li>일반화장대</li><li>좌식화장대</li><li>거울</li></ul>'
                   +'</li><div></div><li class="책상/책장">책상/책장'
                   +'<ul class="store_thirdcategory"><li>일반책상</li><li>좌식책상</li><li>책장</li></ul>'
                   +'</li><div></div><li class="의자">의자'
                   +'<ul class="store_thirdcategory"><li>일반의자</li><li>좌식의자</li><li>안락의자</li></ul></li>'
    let light = '<li class="active">전체</li><div></div><li class="LED등">LED등</li><div></div><li class="스탠드">스탠드'
               +'<ul class="store_thirdcategory"><li>장스탠드</li><li>단스탠드</li></ul>'
               +'</li><div></div><li class="무드등">무드등'
               +'<ul class="store_thirdcategory"><li>무드등</li><li>네온사인</li></ul>'
               +'</li><div></div><li class="센서등">센서등</li><div></div><li class="형광등">형광등</li>'
    let deco = '<li class="active">전체</li><div></div><li class="플라워/식물">플라워/식물'
              +'<ul class="store_thirdcategory"><li>식물</li><li>조화</li></ul>'
              +'</li><div></div><li class="캔들/디퓨져">캔들/디퓨져'
              +'<ul class="store_thirdcategory"><li>캔들</li><li>디퓨져</li></ul>'
              +'</li><div></div><li class="시계">시계'
              +'<ul class="store_thirdcategory"><li>벽시계</li><li>탁상시계</li></ul>'
              +'</li><div></div><li class="인테리어소품">인테리어소품'
              +'<ul class="store_thirdcategory"><li>장식소품</li><li>기타</li></ul></li>'
    let fabric = '<li class="active">전체</li><div></div><li class="침구">침구'
                +'<ul class="store_thirdcategory"><li>이불</li><li>매트리스</li><li>커버</li></ul>'
                +'</li><div></div><li class="커튼/블라인드">커튼/블라인드'
                +'<ul class="store_thirdcategory"><li>커튼</li><li>암막커튼</li><li>블라인드</li></ul>'
                +'</li><div></div><li class="카페트/러그">카페트/러그'
                +'<ul class="store_thirdcategory"><li>카페트</li><li>러그</li><li>다용도매트</li></ul>'
                +'</li><div></div><li class="쿠션/방석">쿠션/방석'
                +'<ul class="store_thirdcategory"><li>쿠션</li><li>방석</li></ul></li>'
    let box = '<li class="active">전체</li><div></div><li class="서랍장">서랍장</li><div></div><li class="리빙박스">리빙박스</li><div></div><li class="바구니">바구니</li><div></div><li class="행거">행거</li><div></div><li class="선반">선반</li><div></div><li class="옷걸이">옷걸이</li><div></div><li class="현관/신발정리">현관/신발정리</li>'
    let setData;
    switch(param){
        case '가구':setData=furniture; break;
        case '조명':setData=light; break;
        case '홈데코':setData=deco; break;
        case '패브릭':setData=fabric; break;
        case '수납정리':setData=box; break;
    }
    $('.store_subcategory').html(setData);
}

// '인기 상품' 리스트
function getProductSortList(jdata) {
    $.ajax({
        url: "http://localhost:3000/getProductSortList",
        type: "post",
        data: jdata,
        success: function (list) {
            console.log(list);
            $("#hotProductList").html('');
            let app = ""
            if (Object.keys(list).length == 0) {	// JSON형식의 길이
                app += '<div style="width: 100%;height:300px; margin: 100px 0 0 0;text-align: center;">'
                    + '<h3 style="font-size: 15px; margin-top: 10px;"><b>게시글이 없습니다.</b></h3>'
                    + "</div>";
                $("#hotProductList").append(app);
            } else {
                $.each(list, function (i, val) {                        
                    app += '<div style="width: 350px; height: 400px; margin: 3px;">'
                        +  '<article article class="project2_wrap" >';
                    
                    if(sessionId != '' && sessionId.auth == 3) {
                        app += '<div class="del_icon"><i name="delete_product_btn" seq="'+val.productSeq+'" class="fa fa-minus-circle fa-lg" aria-hidden="true"></i></div>'
                    };
                        
                    app +=  '<a href="../store/storeDetail.html?seq=' + val.productSeq + '"></a>'
                        +  '<div class="project2_item">'
                        +  '<span></span>'
                        +  '<img src="http://localhost:3000/upload/' + val.productFileName + '" alt="">'
                        +  '</div>'
                        +  '<div class="row" style="margin:0px 40px; margin-top: 15px;margin-bottom: 10px;"><h3 style="font-family: \'Noto Sans KR\'; font-size: 17px; height: 32px;float: none; margin:0 auto;">';
                            
                            if(val.productName.length > 48) {
                                app += val.productName.substr(0,48)+'...';
                            } else {
                                app += val.productName;
                            }     
                            
                        app += '</h3></div><div class="row">';
                        
                    if(val.productDiscount != 0) {
                        app += '<p style="float: none; margin:0 auto;"><span style="font-family: \'Noto Sans KR\';font-size: 15px; color:gray;"><del>'+makeComma(val.productPrice)+'원</del>&nbsp;&nbsp;</span><span style="font-family: \'Noto Sans KR\';font-size: 17px;"><b>' + makeComma(val.productDiscount) + ' 원</b>&nbsp;&nbsp;</span>'
                            + '<span style="font-family: \'Noto Sans KR\';font-size: 17px;color:rgb(244,116,76)"><b>'+discountRate(val.productPrice, val.productDiscount) + '%</b></span></p>';
                    } else {
                        app += '<p style="float: none; margin:0 auto;"><span style="font-family: \'Noto Sans KR\';font-size: 17px;"><b>' + makeComma(val.productPrice) + ' 원</b></span></p>';
                    }

                    app += '</div><div style="font-family: \'Noto Sans KR\'; font-size: 14px;margin-top: 7px;"><i class="fa fa-star" style="font-size: 17px;color: rgb(244,116,76);margin-left: 2px;"></i> ' + val.productRating + '&ensp;│&ensp;<b>리뷰 </b>' + val.reviewCount + '</div>'
                        +  '</article>'
                        +  '</div >';

                });
                $("#hotProductList").append(app);
            }
        },
        error: function () { console.log('error'); }
    });
};

//글의 총 수를 구하는 함수
function getProductSortCount(jdata) {
	$.ajax({
		url:"http://localhost:3000/getProductSortCount",
		type:"get",
		data:jdata,
		success:function(count){ console.log(count); loadPage(count); },
		error:function(){ console.log('error'); }
	});
}
//페이지 처리를 하는 함수
function loadPage(totalCount) {
	let pageSize = 9;
	let nowPage = 1;
	
	let _totalPages = totalCount / pageSize;
	console.log("페이지수:"+_totalPages);
	
	if(totalCount % pageSize > 0){
		//_totalPages = Math.ceil(_totalPages);
		_totalPages++;
	}
	//$(".store_page").twbsPagination("destroy"); //초기화
	$(".store_page").twbsPagination({
		startPage: 1,
		totalPages: _totalPages,
		visiblePages:5, //페이지번호를 몇개까지 보일건가
		first:'<span sria-hidden="true">«</span>',
		prev:"이전",
		next:"다음",
		last:'<span sria-hidden="true">»</span>',
		initiateStartPageClick:false, //온 페이지 클릭이 자동실행여부 결정
		onPageClick:function(event,page){
			nowPage = page;
			console.log('nowPage : '+page);
            getProductSortList(setPdata(3));
            $('html').scrollTop(0)
            //$('html').scrollTop( $('#store_items').offset().top );
		}
	});
    $(".store_page").twbsPagination("changeTotalPages",_totalPages,nowPage);
}

// 분류 데이터 가져와서 json형태로 만들기
function setPdata(date){
    let lc = $('.store_head span').text()
    let mc='', sc='', pNum=0;
    $('.store_subcategory>li').each(function(i){
        if($(this).hasClass('active')){
            let tmp = $(this).html().split('<')[0];
            if(tmp!='전체'){  mc=tmp;  }
        }
    });
    $('.store_thirdcategory>li').each(function(i){
        if($(this).hasClass('active')){
            sc = $(this).text();
        }
    });
    let sort = $('.btn_pop').val();
    $('.pagination>li').each(function(i){
        if($(this).hasClass('active')){
            pNum = $(this).text()-1;
        }
    });
    let param='{"largeCategory":"'+lc+'",';
    param += '"mediumCategory":"'+mc+'",';
    param += '"smallCategory":"'+sc+'",';
    param += '"recentPeriod":"'+date+'",';
    param += '"'+sort.split('=')[0]+'":"'+sort.split('=')[1]+'",'
    param += '"startNum":'+ (pNum*9+1) +','
    param += '"endNum":'+ (pNum*9+9) +'}';
    console.log(JSON.parse(param))
    return JSON.parse(param);
}


// 해쉬태그 랜덤으로 6개 뿌리기
getHashTagList();
function getHashTagList() {

    $.ajax({
		url:"http://localhost:3000/getHashTagList",
		type:"get",
		success:function(list){ 
            console.log(list); 
            //중복 x 랜덤 6개 번호 생성
            let tagNumArr = new Array;
            let sameNum;
            let i = 0;
            while (i < 6) {
                let n = Math.floor(Math.random()*list.length);
                for(let j = 0; j < tagNumArr.length; j++) {
                    if(n === tagNumArr[j]) {
                        sameNum = true;
                        break;
                    } else {
                        sameNum = false;
                    }
                }
                if(!sameNum) {
                    tagNumArr.push(n);
                    i++;
                }
            }
            console.log(tagNumArr);

            for(let i = 0; i < 6; i++) {
                $('#hashTag_'+(i+1)).text('# '+list[tagNumArr[i]].hashTagName);
                $('#hashTag_'+(i+1)).attr('hashTag', list[tagNumArr[i]].hashTagName);
            }

        },
		error:function(){ 
            console.log('getHashTag error'); 
        }
	});
}

$(document).on('click', '.tag', function() {
    location.href = "../commons/search.html?searchWord="+$(this).attr('hashTag');
})

// admin 상품 삭제 버튼
$(document).on('click','i[name=delete_product_btn]' , function() {
    if(confirm("정말 삭제하시겠습니까?")==true) {
        let productSeq = $(this).attr('seq');

        $.ajax({
            url:"http://192.168.0.231:3000/deleteProduct",
            method: "get",
            data:{
                productSeq: productSeq
            },
            success:function(data) {
                if(data == "suc") {
                    alert('상품 삭제가 완료되었습니다.');
                }
            },
            error:function(){
                alert('error');
            },
            complete:function(){
                location.reload();
            }
        });

    } else {
        return;
    }
})


// 정렬버튼 클릭시 순서 새로고침
function setSortBtn(data){
    let text=['인기순','평점순','최신순','판매순']
    let val=['sort=0','sort=1','sort=2','sort=3']
    let k=0
    $('.sub_content_ul button[class=btn_subpop]').each(function(i){
        if(data==text[k]){ k++; }
        $(this).text(text[k]);
        $(this).val(val[k]);
        k++;
    });
}

//인기글 이동
function moveHotmenu(data){
    let page_url = window.location.href;
    let page_id = page_url.substring(page_url.lastIndexOf("?") + 1);
    if(page_id==data){//화면 부드럽게 이동
        $('html, body').animate({ scrollTop: $(data).offset().top }, 400);
        return false;
    }
}

</script>

</html>