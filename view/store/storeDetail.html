<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <link rel="shortcut icon" href="../../assets/img/wanza-Icon.ico" type="image/x-icon">
    <link rel="preconnect" href="https://fonts.gstatic.com">
    <link href="https://fonts.googleapis.com/css2?family=Open+Sans&display=swap" rel="stylesheet">

    <title>완벽한 자취생활, 완자</title>
    <style>




        #sidebox {
            background-color:#ffffff00;
            position: relative;
            width:80%;
            top:450px;
            right:35px;
            padding:1px 5px;
        }
        .star-rating {
            width:100px; 
        }
        .star-rating,.star-rating span { 
            display:inline-block; 
            height:18px; 
            overflow:hidden; 
            background:url(../../assets/img/star.png)no-repeat; 
            background-size: 100px;
        }
        .star-rating span{ 
            background-position:left bottom; 
            line-height:0; 
            vertical-align:top; 
        }

        .star-rating2 {
            width:200px; 
        }
        .star-rating2,.star-rating2 span { 
            display:inline-block; 
            height:33px; 
            overflow:hidden; 
            background:url(../../assets/img/star.png)no-repeat; 
            background-size: 185px;
        }
        .star-rating2 span{ 
            background-position:left bottom; 
            line-height:0; 
            vertical-align:top; 
        }

        .jbFixed {
            position: fixed;
            top: 0px;
            background-color: rgb(255, 255, 255);
            z-index: 2;
        }



        /* 리뷰 modal */

        @media only screen and (min-width: 40em) {
            #reviewModal.modal-overlay {
                display: flex;
                align-items: center;
                justify-content: center;
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                z-index: 5;
                background-color: rgba(0, 0, 0, 0.6);
                opacity: 0;
                visibility: hidden;
                -webkit-backface-visibility: hidden;
                backface-visibility: hidden;
                transition: opacity 0.6s cubic-bezier(0.55, 0, 0.1, 1), visibility 0.6s cubic-bezier(0.55, 0, 0.1, 1);
            }
            #reviewModal.modal-overlay.active {
                opacity: 1;
                visibility: visible;
            }
        }
        /**
        * Modal
        */
        #reviewModal .modal {
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
            margin: 0 auto;
            background-color: rgba(255, 255, 255, 0.267);
            width: 835px;
            max-width: 75rem;
            height: 760px;
            padding: 1.2rem;
            border-radius: 3px;
            opacity: 0;
            overflow-y: auto;
            visibility: hidden;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            -webkit-backface-visibility: hidden;
            backface-visibility: hidden;
            transform: scale(1.2);
            transition: all 0.6s cubic-bezier(0.55, 0, 0.1, 1);
        }
        #reviewModal .modal .close-modal {
            position: absolute;
            cursor: pointer;
            top: 5px;
            right: 15px;
            opacity: 0;
            -webkit-backface-visibility: hidden;
            backface-visibility: hidden;
            transition: opacity 0.6s cubic-bezier(0.55, 0, 0.1, 1), transform 0.6s cubic-bezier(0.55, 0, 0.1, 1);
            transition-delay: 0.3s;
        }
        #reviewModal .modal .close-modal svg {
            width: 1.75em;
            height: 1.75em;
        }
        #reviewModal .modal .modal-content {
            opacity: 0;
            -webkit-backface-visibility: hidden;
            backface-visibility: hidden;
            transition: opacity 0.6s cubic-bezier(0.55, 0, 0.1, 1);
            transition-delay: 0.3s;
            background-color: rgb(255, 255, 255);
            padding: 30px;
        }
        #reviewModal .modal.active {
            visibility: visible;
            opacity: 1;
            transform: scale(1);
        }
        #reviewModal .modal.active .modal-content {
            opacity: 1; 
        }
        #reviewModal .modal.active .close-modal {
            transform: translateY(10px);
            opacity: 1;
        }
        
        /**
        * Mobile styling
        */
        @media only screen and (max-width: 39.9375em) {

            
            #reviewModal .modal {
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                -webkit-overflow-scrolling: touch;
                border-radius: 0;
                transform: scale(1.1);
                padding: 0 !important;
            }
            
            #reviewModal .close-modal {
                right: 20px !important;
            }
        }





        /* 문의 modal */
        @media only screen and (min-width: 40em) {
            #qnaModal.modal-overlay {
                display: flex;
                align-items: center;
                justify-content: center;
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                z-index: 5;
                background-color: rgba(0, 0, 0, 0.6);
                opacity: 0;
                visibility: hidden;
                -webkit-backface-visibility: hidden;
                backface-visibility: hidden;
                transition: opacity 0.6s cubic-bezier(0.55, 0, 0.1, 1), visibility 0.6s cubic-bezier(0.55, 0, 0.1, 1);
            }
            #qnaModal.modal-overlay.active {
                opacity: 1;
                visibility: visible;
            }
        }
        /**
        * Modal
        */
        #qnaModal .modal {
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
            margin: 0 auto;
            background-color: rgba(255, 255, 255, 0.267);
            width: 520px;
            max-width: 75rem;
            height: 750px;
            padding: 1.2rem;
            border-radius: 3px;
            opacity: 0;
            overflow-y: auto;
            visibility: hidden;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            -webkit-backface-visibility: hidden;
            backface-visibility: hidden;
            transform: scale(1.2);
            transition: all 0.6s cubic-bezier(0.55, 0, 0.1, 1);
        }
        #qnaModal .modal .close-modal {
            position: absolute;
            cursor: pointer;
            top: 5px;
            right: 15px;
            opacity: 0;
            -webkit-backface-visibility: hidden;
            backface-visibility: hidden;
            transition: opacity 0.6s cubic-bezier(0.55, 0, 0.1, 1), transform 0.6s cubic-bezier(0.55, 0, 0.1, 1);
            transition-delay: 0.3s;
        }
        #qnaModal .modal .close-modal svg {
            width: 1.75em;
            height: 1.75em;
        }
        #qnaModal .modal .modal-content {
            opacity: 0;
            -webkit-backface-visibility: hidden;
            backface-visibility: hidden;
            transition: opacity 0.6s cubic-bezier(0.55, 0, 0.1, 1);
            transition-delay: 0.3s;
            background-color: rgb(255, 255, 255);
            padding: 30px;
        }
        #qnaModal .modal.active {
            visibility: visible;
            opacity: 1;
            transform: scale(1);
        }
        #qnaModal .modal.active .modal-content {
            opacity: 1; 
        }
        #qnaModal .modal.active .close-modal {
            transform: translateY(10px);
            opacity: 1;
        }
        
        /**
        * Mobile styling
        */
        @media only screen and (max-width: 39.9375em) {

            
            #qnaModal .modal {
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                -webkit-overflow-scrolling: touch;
                border-radius: 0;
                transform: scale(1.1);
                padding: 0 !important;
            }
            
            #qnaModal .close-modal {
                right: 20px !important;
            }
        }



        /* star rating */

        
        .star-label {
            cursor: pointer;
            font-size: 40px;
            color: rgb(244,116,76);
            display: block;
            width: 49px;
            height: 42px;
            line-height: 42px;
            text-align: center;
            float: left;
            -moz-transition: all 0.2s;
            -o-transition: all 0.2s;
            -webkit-transition: all 0.2s;
            transition: all 0.2s;
            text-shadow: 0 4px 4px #6c778896;
        }
        .star-label:hover {
            font-size: 50px;
            color: rgb(240, 177, 158);;
            text-shadow: 0 0 5px #b9c9d8;
        }

        .star-label:active {
            color: rgb(243, 96, 51);
            transform: translateY(3px);
        }





        .star-label:before {
            display: inline;
            width: auto;
            height: auto;
            line-height: normal;
            vertical-align: baseline;
            margin-top: 0;
            font-family: FontAwesome;
            font-weight: normal;
            font-style: normal;
            text-decoration: inherit;
            -webkit-font-smoothing: antialiased;
            content: "\f005";
        }
        
        input:checked + .star-label ~ .star-label:before {
            content: "\f006";
        }
        
        #wrapper {
            display: inline-block;
            text-align: center;
        }
        
        #wrapper:hover .star-label:before {
            content: "\f005";
        } 

        #wrapper:hover .star-label:hover ~ .star-label:before {
            content: "\f006";
        }


        .uploadImg {
            height:230px;
            width: 230px;
            filter: brightness(105%);
            object-fit: cover;
            border-radius: 5px;
        }
        
        .uploadImg:hover {
            filter: brightness(85%);
        }
        .uploadImg:active {
            filter: brightness(115%);
            transform: translateY(2px);
        }



        /* 결제 버튼 */
        .review_write_btn{
            width: 140px;
            height: 45px;
            margin: 10px 0;
            border-radius: 5px;
            color: white;
            border: none;
            background-color: #f4744c;
            font: 1.2em bold;
        }
        .review_write_btn:hover{
            color: #f4744c;
            background-color: white;
            border: 0.5px solid #f4744c;
        }

        /* 문의 버튼 */
        .qna_write_btn{
            width: 90%;
            height: 45px;
            margin-left: 22px;
            border-radius: 5px;
            color: white;
            border: none;
            background-color: #f4744c;
            font: 1.2em bold;
        }
        .qna_write_btn:hover{
            color: #f4744c;
            background-color: white;
            border: 0.5px solid #f4744c;
        }

    </style>
</head>
<body>
    <header include-html="../commons/header.html"></header>
    <nav include-html="../commons/menuStore.html"></nav>
    


    
    <!-- 리뷰 모달 -->
    <div id="reviewModal" class="modal-overlay">
        <div class="modal">
        <a class="close-modal">
            <svg viewBox="0 0 20 20">
            <path fill="#000000" d="M15.898,4.045c-0.271-0.272-0.713-0.272-0.986,0l-4.71,4.711L5.493,4.045c-0.272-0.272-0.714-0.272-0.986,0s-0.272,0.714,0,0.986l4.709,4.711l-4.71,4.711c-0.272,0.271-0.272,0.713,0,0.986c0.136,0.136,0.314,0.203,0.492,0.203c0.179,0,0.357-0.067,0.493-0.203l4.711-4.711l4.71,4.711c0.137,0.136,0.314,0.203,0.494,0.203c0.178,0,0.355-0.067,0.492-0.203c0.273-0.273,0.273-0.715,0-0.986l-4.711-4.711l4.711-4.711C16.172,4.759,16.172,4.317,15.898,4.045z"></path>
            </svg>
        </a>
        <div class="modal-content">
            <form id="upload_frm">
                <input type="hidden" id="purchaseSeq" name="purchaseSeq">
                <input type="hidden" id="reviewProductSeq" name="productSeq">
                <input type="hidden" id="reviewUserSeq" name="userSeq">
                <div>
                    <div class="row" style="margin-bottom: 10px;">
                        <div class="col" style="margin-top: 20px; margin-bottom: 1px;">
                            <p style="font-size: 30px; font-weight: 500;">해당 상품이 마음에 드셨나요? 상품을 평가해주세요.</p>
                        </div>
                    </div>
                    <hr>
                    <div class="row" style="margin:25px 0px;">
                        <div class="col-xl-2" style="margin-top: 20px;">
                            <img id="reviewProductImg" name="productImg" src="../../assets/img/1582386824.jpg" style="width: 90px; height: 90px; border-radius: 5px; margin-left: 3px;">
                        </div>
                        <div class="col-xl-4 offset-xl-0" style="padding-top: 7px; padding-left: 30px;">
                            <div class="row">
                                <p id="reviewProductTitle" name="productTitle" style="font-size: 19px;" style="display : flex; align-items:center; font-weight: 500;">모노 서랍장 3/4/5단 서랍장</p>
                            </div>
                            <div class="row">
                                <p style="font-size: 13px;"><span id="opKey">옵션명</span><span> : </span><span id="opValue">옵션항목</span><span>&ensp;&ensp;개수 : </span><span id="productCount">0</span><span>개</span></p>
                            </div>
                        </div>
                        <div class="col-xl-4 offset-xl-1">
                            <div id="wrapper" style="width: 250px; margin-top: 30px; margin-left: 30px;">
                                <input type="radio" id="star1" class="star-rating-icon" name="productRevRating" style="display: none;" value="1" checked/>
                                <label for="star1" class="star-label"></label>
                                <input type="radio" id="star2" class="star-rating-icon" name="productRevRating" style="display: none;" value="2"/>
                                <label for="star2" class="star-label"></label>
                                <input type="radio" id="star3" class="star-rating-icon" name="productRevRating" style="display: none;" value="3"/>
                                <label for="star3" class="star-label"></label>
                                <input type="radio" id="star4" class="star-rating-icon" name="productRevRating" style="display: none;" value="4"/>
                                <label for="star4" class="star-label"></label>
                                <input type="radio" id="star5" class="star-rating-icon" name="productRevRating" style="display: none;" value="5"/>
                                <label for="star5" class="star-label"></label>
                            </div>
                        </div>
                    </div>
                    <hr>
                    <div class="row" style="margin-top: 25px; margin-bottom: 10px;">   
                        <div class="col">
                            <textarea id="reviewContent" name="productRevContent" style="width: 435px; height: 230px; resize: none; background-color: #ececec; border: none; border-radius: 8px; padding: 15px;" placeholder="상품에 대한 리뷰를 남겨주세요. 상품 사진을 추가하시면 적립포인트 100P를 추가로 드립니다. "></textarea>
                        </div>
                        <div class="col">
                            <img src="../../assets/img/imgUpload.png" id="_uploadImg" class="uploadImg">
                            <input type="file" id="_file" name="fileName" style="display:none;">
                            <input type="hidden" id="_target_url" name="target_url">
                        </div>
                    </div> 
                    
                    <div class="row" style="float: right; margin-right: 10px;">
                        <input type="button" class="review_write_btn" value="작성하기">
                    </div>
                </div>
            </form>
        </div>
        </div>
    </div>
    <!-- 리뷰 모달 end -->


    <!-- 문의 모달 -->
    <div id="qnaModal" class="modal-overlay">
        <div class="modal">
        <a class="close-modal">
            <svg viewBox="0 0 20 20">
            <path fill="#000000" d="M15.898,4.045c-0.271-0.272-0.713-0.272-0.986,0l-4.71,4.711L5.493,4.045c-0.272-0.272-0.714-0.272-0.986,0s-0.272,0.714,0,0.986l4.709,4.711l-4.71,4.711c-0.272,0.271-0.272,0.713,0,0.986c0.136,0.136,0.314,0.203,0.492,0.203c0.179,0,0.357-0.067,0.493-0.203l4.711-4.711l4.71,4.711c0.137,0.136,0.314,0.203,0.494,0.203c0.178,0,0.355-0.067,0.492-0.203c0.273-0.273,0.273-0.715,0-0.986l-4.711-4.711l4.711-4.711C16.172,4.759,16.172,4.317,15.898,4.045z"></path>
            </svg>
        </a>
        <div class="modal-content">
                <div>
                    <div class="row" style="margin-bottom: 10px;">
                        <div class="col" style="margin-top: 20px; margin-bottom: 1px;">
                            <p style="font-size: 20px; font-weight: bold;">상품 문의하기</p>
                        </div>
                    </div>
                    <hr>
                    <div class="row" style="margin:10px 0px;">
                        <div class="col-xl-2" style="margin-top: 20px;">
                            <img id="qnaProductImg" name="productImg" src="../../assets/img/1582386824.jpg" style="width: 75px; height: 75px; border-radius: 5px; margin-left: 3px; margin-bottom: 18px;">
                        </div>
                        <div class="col-xl-8 offset-xl-1" style="padding-top: 7px; padding-left: 30px;display : flex; align-items:center;">
                            <div class="row">
                                <p id="qnaProductTitle" name="productTitle" style="font-size: 17px;" style="font-weight: 500;">모노 서랍장 3/4/5단 서랍장</p>
                            </div>
                        </div>
                    </div>
                    <hr>
                    <div class="row" style="margin-top: 25px; margin-bottom: 10px;">   
                        <div class="col">
                            <textarea id="qnaContent" name="qnaRevContent" style="width: 420px; height: 230px; resize: none; background-color: #ececec; border: none; border-radius: 8px; padding: 15px;" placeholder="문의 내용을 입력하세요."></textarea>
                        </div>
                    </div> 
                    <hr>
                    <div class="row" style="float: none; margin: 0 auto;">
                        <input type="button" class="qna_write_btn" value="작성하기">
                    </div>
                </div>
            </form>
        </div>
        </div>
    </div>
    <!-- 문의 모달 end -->





    <div class="row">
        <div class="col-md-1 invisible"></div>
        <div class="col-md-8">
            <ol class="breadcrumb mx-auto" style="background: rgb(255,255,255);width: 800px;margin: 15px;margin-left: 0px;">
                <li class="breadcrumb-item"><a href="#"><span style="color: rgb(105,105,105);">Home</span></a></li>
                <li class="breadcrumb-item"><a href="#"><span style="color: rgb(100,100,100);">가구</span></a></li>
                <li class="breadcrumb-item"><a href="#"><span style="color: rgb(100,100,100);">책상/책장</span></a></li>
            </ol>
            
        </div>
    </div>
    <div class="row" style="width: 1050px;margin: 0 auto;margin-top: 0px;">
        <div class="col" style="width: 1118px;">
            <div style="position: relative;padding-top: 100%; width: 630px; height: 630px; overflow: hidden;">
                <div style="position: absolute;top: 0;left: 0;right: 0;bottom: 0;transform: translate(50%, 50%);">
                    <img id="mainImg" style="height: 100%;transform: translate(-50%, -50%);">
                </div>
            </div>            
        </div>


        <!-- 오른쪽 상품 정보란 -->
        <div class="col" style="width: 400px;">
            <div class="row">
                <div class="col"
                    style="margin: 17px 0px 0px 16px;margin-left: 16px;font-family: 'Noto Sans KR', sans-serif;width: 250px;margin-top: 14px;border-bottom: 1px none rgb(99,99,99) ;">
                    <h5 id="maker" style="font-size: 15px;margin-top: 10px;margin-left: 10px;"><!--제품회사이름--></h5>
                    <h1 id="title" style="font-size: 30px;margin: 10px;"><!--제목--></h1>
                    
                </div>
            </div>
            <div class="row"  style="margin:0px 0px 0px 16px;">
                <div style="margin: 10px;">
                    <!-- <i class="fa fa-star" style="font-size: 18px;color: rgb(244,116,76);margin-left: 2px;"></i> -->
                    <span class="star-rating">
                        <span id="starRating"></span>
                    </span>
                    <span id="rating" style="font-size: 20px;margin-left: 14px;"><!--별점-->></span>
                    <span style="margin-left: 20px;font-size: 14px;color: rgb(99,99,99);">후기 <span name="reviewCount"></span></span>
                </div>
            </div>
            <div class="row">
                <div class="col">
                    <div style="border-bottom: 1px solid rgb(99,99,99);height: 70px; margin-left: 20px;font-family: 'Noto Sans KR', sans-serif;text-align: left;">
                        <span style="margin: 10px;font-size: 17px;width: auto;color: rgb(99,99,99);margin-top: 10px;padding: 0px;padding-top: 0px;">
                            <span id="costPrice" style="text-decoration: line-through;"><!--정가--></span>
                            <span id="sellPrice" style="margin: 10px;font-size: 27px;margin-left: 17px;color: rgb(0,0,0);margin-top: 10px;padding: 0px;padding-top: 0px;">
                                <strong id="discountPrice"><!--판매가--></strong>원
                            </span>
                        </span>
                        <span style="margin: 10px;font-size: 24px;margin-left: 0px;color: rgb(244,116,76);margin-top: 10px;padding: 0px;padding-top: 0px;">
                        <strong id="discountRate"><!--할인율--></strong></span>
                    </div>
                </div>
            </div>
            <div class="row">
                <div class="col"
                    style="height: 31px;margin: 0px;margin-top: 15px;font-family: 'Noto Sans KR', sans-serif;padding-left: 25px;">
                    <span style="margin: 15px;color: rgb(101,101,101);"><strong>회원적립</strong></span><span
                        style="margin: 15px;"><strong id="point">267</strong>P<strong> </strong>적립</span></div>
            </div>
            <div class="row" style="margin-top: -3px;">
                <div class="col"
                    style="margin-top: 10px;margin-bottom: 15px;font-family: 'Noto Sans KR', sans-serif;padding-left: 25px;">
                    <span style="margin: 15px;color: rgb(101,101,101);"><strong>배송비</strong></span><span
                        style="margin: 15px;margin-left: 30px;color: rgb(99,99,99);font-family: 'Noto Sans KR', sans-serif;">2,500원
                        (5만원 이상 무료)</span></div>
            </div>
            <div id="optionList">
            </div>
            <!-- 옵션 리스트 뿌려지는 곳 -->
            
            <div class="row"
                style="margin-left: 10px;border-bottom: 1px solid rgb(99,99,99);padding-bottom: 13px;width: 355px;"><span
                    style="margin: 15px;color: rgb(101,101,101);font-family: 'Noto Sans KR', sans-serif;"><strong>개수</strong></span>
                <div class="col">
                    <input id="itemCount" class="border rounded-0 form-control-sm" type="number" min="1" max="10" placeholder="1" value="1" style="margin-top: 12px;height: 33px;width: 88px;margin-left: 28px;">
                </div>
            </div>
            <div class="row" style="margin-top: 26px;">
                <div class="col" style="margin-top: 16px;margin-left: 17px;margin-bottom: 40px;"><span
                        style="font-size: 20px;font-family: 'Noto Sans KR', sans-serif;margin-left: 20px;"><strong>총
                            상품금액</strong></span><span
                        style="font-size: 25px;font-family: 'Noto Sans KR', sans-serif;margin-left: 82px;"><strong id="totalPrice"><!-- 총액 표시 --></strong></span>
                </div>
            </div>
            <div class="row">
                <div class="col" style="margin-top: 23px;">
                    <button id="cartBtn" class="btn btn-lg" onclick="addCart()" type="button" data-container="body" data-toggle="popover" data-placement="top" data-content="장바구니에 담았습니다."
                        style="width: 161.375px;height: 48px;margin-left: 8px;border-color: rgb(244,116,76);border-bottom-color: rgb(244,116,76);font-family: 'Noto Sans KR', sans-serif;color: rgb(244,116,76);font-size: 18px;">장바구니</button>
                    <button class="btn btn-lg" type="button"
                    style="width: 161.375px;height: 48px;margin-left: 8px;background: rgb(244,116,76);font-family: 'Noto Sans KR', sans-serif;color: rgb(255,255,255);font-size: 18px;" onclick="directPurchase()">바로구매</button>
                </div>
            </div>
        </div>
    </div>

    <div class="container" style="width: 1200px; margin-top: 50px;">
        <div class="row" style="width: 1200px;">
            <div class="col-md-8" style="position: relative;">
                <div id="miniMenu">
                    <ul class="nav nav-tabs" style="z-index: 2; width: 770px;">
                        <li class="nav-item">
                            <div id="contentBtn" name="miniMenu" class="nav-link" style="cursor: pointer; font-family: 'Noto Sans KR', sans-serif;width: 150px;text-align: center;border-top-style: none;border-right-style: none;border-bottom-width: 3px;border-bottom-color: rgb(244,116,76);border-left-style: none;">
                                상품정보</div>
                        </li>
                        <li class="nav-item">
                            <div class="nav-link" name="miniMenu" id="reviewBtn" style="cursor: pointer; color: rgb(101,101,101);font-family: 'Noto Sans KR', sans-serif;width: 150px;text-align: center;border-top-style: none;border-right-style: none;border-left-style: none;">
                                후기 <span name="reviewCount"></span></div>
                        </li>
                        <li class="nav-item">
                            <div class="nav-link" name="miniMenu" id="questionBtn" style="cursor: pointer; color: rgb(99,99,99);font-family: 'Noto Sans KR', sans-serif;width: 150px;text-align: center;border-top-style: none;border-right-style: none;border-left-style: none;">
                                문의 <span name="qnaCount">0</span></div>
                        </li>
                        <li class="nav-item">
                            <div class="nav-link" name="miniMenu" id="deliveryBtn" style="cursor: pointer; color: rgb(99,99,99);font-family: 'Noto Sans KR', sans-serif;width: 150px;text-align: center;border-top-style: none;border-right-style: none;border-left-style: none;">
                                배송/환불</div>
                        </li>
                    </ul>
                </div>

                <div id="content" style="margin-top: 50px;">
                    <!-- 상품 내용 (썸머노트) 뿌려주는 곳 -->
                </div>

                <div id="reviewSlide"></div>
                <div id="review" class="row" style="margin-top: 70px; margin-bottom: 5px;">
                    <div class="col">
                        <h4><strong>후기</strong><span name="reviewCount" style="margin-left: 10px;color: rgb(119,119,119);">23</span></h4>
                    </div>
                    <div class="col-xl-3"><button id="reviewWriteBtn" class="btn btn-primary" type="button"
                            style="width: 120px;color: rgb(244,116,76);background: rgb(255,255,255);margin-left: 45px;border-width: 1px;border-color: rgb(244,116,76);font-size: 15px;"><strong>후기</strong>
                            <strong>작성</strong></button></div>
                </div>








                <div class="row">
                    <div class="col">
                        <p style="font-size: 14px;">상품 구매 후, 후기 작성 시 포인트를 드립니다. (일반 후기 : 50P / 사진 후기 : 150P)</p>
                    </div>
                </div>
                <div class="row" style="background: rgb(232,232,232);padding-top: 15px;padding-bottom: 15px;">
                    <div class="col-xl-5">
                        <div class="row">
                            <div class="col-xl-12" style="text-align: center;margin-top: 16px;">
                                <h1><span id="productRating">4.4</span> / 5</h1>
                            </div>
                        </div>
                        <div class="row">
                            <span class="star-rating2" style="margin:0 73px;">
                                <span id="starRating2"></span>
                            </span>
                        </div>
                    </div>
                    <div class="col-xl-7">



                        <div class="row">
                            <div class="col-xl-2" style="text-align: right;"><span
                                    style="font-size: 12px;color: rgb(130,130,130);"><strong>5점</strong></span></div>
                            <div class="col-xl-7">
                                <div class="progress border rounded-0 border-primary"
                                    style="height: 6px;width: 221px;margin: 0px;margin-top: 10px;color: var(--red);background: var(--white);">
                                    <div class="progress-bar progress-bar-animated" aria-valuenow="83" aria-valuemin="0"
                                        aria-valuemax="100" style="width: 83%;"><span class="sr-only">83%</span></div>
                                </div>
                            </div>
                            <div class="col-xl-2" style="text-align: left;"><span
                                    style="font-size: 11px;color: rgb(130,130,130);"><strong>63명</strong></span></div>
                        </div>



                        <div class="row">
                            <div class="col-xl-2" style="text-align: right;"><span
                                    style="font-size: 12px;color: rgb(130,130,130);"><strong>4점</strong></span></div>
                            <div class="col-xl-7">
                                <div class="progress border rounded-0 border-primary"
                                    style="height: 6px;width: 221px;margin: 0px;margin-top: 10px;color: var(--red);background: var(--white);">
                                    <div class="progress-bar progress-bar-animated" aria-valuenow="15" aria-valuemin="0"
                                        aria-valuemax="100" style="width: 15%;"><span class="sr-only">15%</span></div>
                                </div>
                            </div>
                            <div class="col-xl-2" style="text-align: left;"><span
                                    style="font-size: 11px;color: rgb(130,130,130);"><strong>8명</strong></span></div>
                        </div>
                        <div class="row">
                            <div class="col-xl-2" style="text-align: right;"><span
                                    style="font-size: 12px;color: rgb(130,130,130);"><strong>3점</strong></span></div>
                            <div class="col-xl-7">
                                <div class="progress border rounded-0 border-primary"
                                    style="height: 6px;width: 221px;margin: 0px;margin-top: 10px;color: var(--red);background: var(--white);">
                                    <div class="progress-bar progress-bar-animated" aria-valuenow="10" aria-valuemin="0"
                                        aria-valuemax="100" style="width: 10%;"><span class="sr-only">10%</span></div>
                                </div>
                            </div>
                            <div class="col-xl-2" style="text-align: left;"><span
                                    style="font-size: 11px;color: rgb(130,130,130);"><strong>5명</strong></span></div>
                        </div>
                        <div class="row">
                            <div class="col-xl-2" style="text-align: right;"><span
                                    style="font-size: 12px;color: rgb(130,130,130);"><strong>2점</strong></span></div>
                            <div class="col-xl-7">
                                <div class="progress border rounded-0 border-primary"
                                    style="height: 6px;width: 221px;margin: 0px;margin-top: 10px;color: var(--red);background: var(--white);">
                                    <div class="progress-bar progress-bar-animated" aria-valuenow="5" aria-valuemin="0"
                                        aria-valuemax="100" style="width: 5%;"><span class="sr-only">5%</span></div>
                                </div>
                            </div>
                            <div class="col-xl-2" style="text-align: left;"><span
                                    style="font-size: 11px;color: rgb(130,130,130);"><strong>2명</strong></span></div>
                        </div>
                        <div class="row">
                            <div class="col-xl-2" style="text-align: right;"><span
                                    style="font-size: 12px;color: rgb(130,130,130);"><strong>1점</strong></span></div>
                            <div class="col-xl-7">
                                <div class="progress border rounded-0 border-primary"
                                    style="height: 6px;width: 221px;margin: 0px;margin-top: 10px;color: var(--red);background: var(--white);">
                                    <div class="progress-bar progress-bar-animated" aria-valuenow="2" aria-valuemin="0"
                                        aria-valuemax="100" style="width: 2%;"><span class="sr-only">2%</span></div>
                                </div>
                            </div>
                            <div class="col-xl-2" style="text-align: left;"><span
                                    style="font-size: 11px;color: rgb(130,130,130);"><strong>1명</strong></span></div>
                        </div>
                    </div>
                </div>

                <div class="row" style="height: 80px;">
                    <div class="col" style="text-align: right;padding-top: 15px;border-bottom: 1px solid rgb(99,99,99);height: 70px;">
                        <div class="dropdown"><button class="btn dropdown-toggle" aria-expanded="false" data-toggle="dropdown"
                                type="button">별점&nbsp;</button>
                            <div class="dropdown-menu">
                                <a class="dropdown-item" href="#" style="color: #f4744c;">★★★★★</a>
                                <a class="dropdown-item" href="#" style="color: #f4744c;">★★★★</a>
                                <a class="dropdown-item" href="#" style="color: #f4744c;">★★★</a>
                                <a class="dropdown-item" href="#" style="color: #f4744c;">★★</a>
                                <a class="dropdown-item" href="#" style="color: #f4744c;">★</a>
                            </div>
                        </div>
                    </div>
                </div>

                <div id="productReview"></div>
                <!-- 리뷰 글 리스트 -->

                <!-- <div class="row" style="padding-top: 18px;padding-left: 0px;padding-bottom: 20px;border-bottom: 1px solid rgb(150,150,150) ;">
                    <div class="col">
                        <div class="row">
                            <div class="col"><span style="font-size: 17px;">★★★★★</span>
                                <span style="margin-left: 10px;font-size: 15px;">nickname01</span>
                                <span style="margin-left: 5px;">&nbsp;·&nbsp;</span>
                                <span style="margin-left: 10px;font-size: 13px;">2021.01.01</span>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col" style="margin: 25px 0px;">
                                <span style="font-size: 14px;">
                                    우리집 고영희가 좋아해요. 그럼 다 된거에요. 이만한 가성비 오지는 제품이 없습니다. 판매자님 많이
                                    팔아 부자되시고 건강하십시오.
                                </span>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col"><img src="../../assets/img/1582386824.jpg" width="130px" style="border-radius: 10px;"></div>
                        </div>
                    </div>
                </div> -->



                <!-- Pagination -->
                <div class="row" style="margin-top: 20px;" style="justify-content:center;">
                    <div class="col offset-xl-3">
                        <nav aria-label="Page navigation">
                            <ul class="pagination" id="pagination"></ul>
                        </nav>
                    </div>
                </div>



                <div id="questionSlide"></div>
                <div id="question" class="row"
                    style="padding-top: 20px;padding-bottom: 20px;border-bottom: 1px solid rgb(101,101,101);margin-top: 70px; margin-bottom: 18px;">
                    <div class="col">
                        <h4><strong>문의</strong><span name="qnaCount" style="margin-left: 10px;color: rgb(119,119,119);">0</span></h4>
                    </div>
                    <div class="col-xl-3"><button id="qnaWriteBtn" class="btn btn-primary" type="button"
                            style="width: 120px;color: rgb(244,116,76);background: rgb(255,255,255);margin-left: 45px;border-width: 1px;border-color: rgb(244,116,76);font-size: 15px;"><strong>문의하기</strong><br></button>
                    </div>
                </div>

                <!-- 문의글 뿌려지는 곳 -->
                <div id="productQnA"></div>
                
                <!-- Pagination -->
                <div class="row" style="margin-top: 20px;" style="justify-content:center;">
                    <div class="col offset-xl-3">
                        <nav aria-label="Page navigation">
                            <ul class="pagination" id="pagination_qna"></ul>
                        </nav>
                    </div>
                </div>


                <div id="delivery" class="row"
                    style="padding-top: 20px;padding-bottom: 20px;border-bottom: 1px solid rgb(101,101,101);margin-top: 70px;">
                    <div class="col">
                        <h4><strong>배송/환불</strong></h4>
                    </div>
                </div>
                <div class="row">
                    <div class="col">
                        <div class="row" style="margin-top: 20px;">
                            <div class="col" style="border-bottom-width: 1px;border-bottom-style: solid;">
                                <h5>배송</h5>
                            </div>
                        </div>
                        <div class="row" style="border-bottom: 1px solid rgb(170,170,170);">
                            <div class="col-xl-3" style="background: #e6e6e6;padding-top: 5px;padding-bottom: 5px;"><span
                                    style="font-size: 14px;color: rgb(99,99,99);"><strong>배송</strong></span></div>
                            <div class="col" style="padding-top: 5px;padding-bottom: 5px;"><span style="font-size: 14px;">일반택배</span>
                            </div>
                        </div>
                        <div class="row" style="border-bottom: 1px solid rgb(170,170,170);">
                            <div class="col-xl-3" style="background: #e6e6e6;padding-top: 5px;padding-bottom: 5px;"><span
                                    style="font-size: 14px;color: rgb(99,99,99);"><strong>배송비</strong><br></span></div>
                            <div class="col" style="padding-top: 5px;padding-bottom: 5px;"><span style="font-size: 14px;">2,500원 (5만원 이상
                                    무료배송)</span></div>
                        </div>
                        <div class="row" style="border-bottom: 1px solid rgb(170,170,170);">
                            <div class="col-xl-3" style="background: #e6e6e6;padding-top: 5px;padding-bottom: 5px;"><span
                                    style="font-size: 14px;color: rgb(99,99,99);"><strong>도서산간 추가 배송비</strong></span></div>
                            <div class="col" style="padding-top: 5px;padding-bottom: 5px;"><span style="font-size: 14px;">3,000원</span>
                            </div>
                        </div>
                        <div class="row" style="border-bottom: 1px solid rgb(170,170,170);">
                            <div class="col-xl-3" style="background: #e6e6e6;padding-top: 5px;padding-bottom: 5px;"><span
                                    style="font-size: 14px;color: rgb(99,99,99);"><strong>배송불가 지역</strong></span></div>
                            <div class="col" style="padding-top: 5px;padding-bottom: 5px;"><span style="font-size: 14px;">배송불가 지역이
                                    없습니다.</span></div>
                        </div>
                    </div>
                </div>
                <div class="row" style="margin-top: 20px; margin-bottom: 100px;">
                    <div class="col">
                        <div class="row" style="margin-top: 20px;">
                            <div class="col" style="border-bottom-width: 1px;border-bottom-style: solid;">
                                <h5>환불</h5>
                            </div>
                        </div>
                        <div class="row" style="border-bottom: 1px solid rgb(170,170,170);">
                            <div class="col-xl-3" style="background: #e6e6e6;padding-top: 5px;padding-bottom: 5px;"><span
                                    style="font-size: 14px;color: rgb(99,99,99);"><strong>반품배송비</strong></span></div>
                            <div class="col" style="padding-top: 5px;padding-bottom: 5px;"><span style="font-size: 14px;">3,000원 (최초
                                    배송비가 무료인 경우 6,000원 부과)</span></div>
                        </div>
                        <div class="row" style="border-bottom: 1px solid rgb(170,170,170);">
                            <div class="col-xl-3" style="background: #e6e6e6;padding-top: 5px;padding-bottom: 5px;"><span
                                    style="font-size: 14px;color: rgb(99,99,99);"><strong>교환배송비</strong></span></div>
                            <div class="col" style="padding-top: 5px;padding-bottom: 5px;"><span style="font-size: 14px;">6,000원</span>
                            </div>
                        </div>
                        <div class="row" style="border-bottom: 1px solid rgb(170,170,170);">
                            <div class="col-xl-3" style="background: #e6e6e6;padding-top: 5px;padding-bottom: 5px;"><span
                                    style="font-size: 14px;color: rgb(99,99,99);"><strong>보내실 곳</strong></span></div>
                            <div class="col" style="padding-top: 5px;padding-bottom: 5px;"><span style="font-size: 14px;">(02830) 서울 마포구
                                    백범로 23 구프라자 3층</span></div>
                        </div>
                    </div>
                </div>
            </div>



            <!-- 스크롤 따라다니는 div -->
            <div id="sidebox" class="col-md-4">
                <div id="optionList_side">
                </div>
                <!-- 옵션 리스트 뿌려지는 곳 -->

                <div class="row" style="margin-left: 10px;border-bottom: 1px solid rgb(99,99,99);padding-bottom: 13px;width: 355px;">
                    <div class="col-md-5">
                        <span style="color: rgb(101,101,101);font-family: 'Noto Sans KR', sans-serif;"><strong>개수</strong></span>
                    </div>
                    <div class="col-md-5">
                        <input id="itemCount_side" class="border rounded-0 form-control-sm" type="number" min="1" max="10" placeholder="1" value="1" style="height: 33px;width: 88px;margin-left: 5px;">
                    </div>
                </div>
                <div class="row" style="margin-top: 26px;">
                    <div class="col" style="margin-top: 16px;margin-left: 17px;margin-bottom: 40px;"><span
                            style="font-size: 20px;font-family: 'Noto Sans KR', sans-serif;margin-left: 20px;"><strong>총
                                상품금액</strong></span><span
                            style="font-size: 25px;font-family: 'Noto Sans KR', sans-serif;margin-left: 82px;"><strong id="totalPrice_side"><!-- 총액 표시 --></strong></span>
                    </div>
                </div>
                <div class="row" style="width: 382.656px;">
                    <div class="col" style="margin-top: 23px;"><button id="sideCartBtn" class="btn btn-lg" onclick="addCart()" type="button"
                            style="width: 161.375px;height: 48px;margin-left: 8px;border-color: rgb(244,116,76);border-bottom-color: rgb(244,116,76);font-family: 'Noto Sans KR', sans-serif;color: rgb(244,116,76);font-size: 18px;">장바구니</button><button
                            class="btn btn-lg" type="button"
                            style="width: 161.375px;height: 48px;margin-left: 8px;background: rgb(244,116,76);font-family: 'Noto Sans KR', sans-serif;color: rgb(255,255,255);font-size: 18px;" onclick="directPurchase()">바로구매</button>
                    </div>
                </div>
            </div>



        </div>
    </div>



    <footer include-html="../commons/footer.html"></footer>
    
    
    <script src="../../assets/js/jquery.min.js"></script>
    <script src="../../assets/bootstrap/js/bootstrap.min.js"></script>
    <script src="../../js/includeHTML.js"></script>
    <script src="../../js/header.js"></script>
    <script type="text/javascript" src="../../js/jquery.twbsPagination.min.js"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/ekko-lightbox/5.3.0/ekko-lightbox.css" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/ekko-lightbox/5.3.0/ekko-lightbox.min.js"></script>


    <script>

    //파라미터값 가져오도록 하는 함수
    function getParameter(name) {
        name = name.replace(/[\[]/, "\\[").replace(/[\]]/, "\\]");
        var regex = new RegExp("[\\?&]" + name + "=([^&#]*)"),
            results = regex.exec(location.search);
        return results === null ? "" : decodeURIComponent(results[1].replace(/\+/g, " "));
    }
    const productSeq = getParameter("seq");

    //로그인한 계정 닉네임 가져오기
    let sessionId = JSON.parse(sessionStorage.getItem("login"));
    if (sessionId == null) {
        sessionId = '';
    };
    const userSeq = sessionId.userSeq;

    // 금액 콤마 삽입 정규식
    function makeComma(str) {

        str = String(str);
        return str.replace(/(\d)(?=(?:\d{3})+(?!\d))/g, '$1,');
    };


    //할인 퍼센테이지 계산
    function discountRate(price, discount) {
        return Math.ceil(100- (discount/price*100));
    };

    // 장바구니 버튼 부트스트랩
    $(function () {
        $('[data-toggle="popover"]').popover({
            trigger: 'focus'
        })
    })


    // 상품 옵션, 개수 사이드바와 연동 (개수 조절 시 총금액 변동)
    /*
    $('#selectItem').change(function () {
        $('#selectItem_side').val($(this).val()).attr('selected');
    });
    $('#selectItem_side').change(function () {
        $('#selectItem').val($(this).val()).attr('selected');
    });
    */

    $(document).on('change', 'select[name=selectItem_1]', function() {
        $('select[name=selectItem_1]').val($(this).val()).attr('selected');
    });
    $(document).on('change', 'select[name=selectItem_2]', function() {
        $('select[name=selectItem_2]').val($(this).val()).attr('selected');
    });
    $(document).on('change', 'select[name=selectItem_3]', function() {
        $('select[name=selectItem_3]').val($(this).val()).attr('selected');
    });
    $(document).on('change', 'select[name=selectItem_4]', function() {
        $('select[name=selectItem_4]').val($(this).val()).attr('selected');
    });
    $(document).on('change', 'select[name=selectItem_5]', function() {
        $('select[name=selectItem_5]').val($(this).val()).attr('selected');
    });


    $('#itemCount').change(function() {
        if($(this).val() < 1) {
            $(this).val(1)
        }
        else if($(this).val() > 11) {
            $(this).val(10)
        }
        else {
            $(this).val(Math.floor($(this).val()));
        };
        $('#itemCount_side').val($(this).val());
        $('#totalPrice, #totalPrice_side').text(makeComma($('#discountPrice').text().replace(',', '') * $(this).val()) + '원');
    });
    $('#itemCount_side').change(function() {
        if ($(this).val() < 1) {
            $(this).val(1)
        } 
        else if ($(this).val() > 11) {
            $(this).val(10)
        }
        else {
            $(this).val(Math.floor($(this).val()));
        };
        $('#itemCount').val($(this).val());
        $('#totalPrice, #totalPrice_side').text(makeComma($('#discountPrice').text().replace(',', '') * $(this).val()) + '원');
    });

    // 바로구매 기능
    function directPurchase() {

        let selectItem = $('#selectItem').val();
        let itemCount = $('#itemCount').val();
        location.href = "order.html?seq="+productSeq+"&selectItem=" +selectItem+"&itemCount="+itemCount;
    };
    
    // 장바구니 담기
    function addCart() {

        $.ajax({
            url: "http://192.168.0.231:3000/addCart",
            type: "get",
            data: {
                "cartClassify":"CT-"+sessionId.userSeq,
                "userSeq": sessionId.userSeq,
                "productSeq":productSeq,
                "selectOption":"{\""+$('#selectKey').text()+"\":\""+$('#selectItem').val()+"\"}",
                "quantity":$('#itemCount').val(),
                "price":$('#sellPrice').text().replace(/[^0-9]/g, '')
            },
            success: function (data) {
                console.log(data);
                if(data=="suc") {
                    console.log('장바구니에 담았습니다.');
                }
                else if(data=="exist") {
                    $('#cartBtn').attr("data-content","장바구니에 이미 담겨있습니다.");
                    alert('장바구니에 이미 담겨있습니다.');
                }
                else {
                    console.log('장바구니에 담기 실패');
                }
            },
            error: function () {
                alert('addCart() error');
            },
            complete:function(data) {

            }
        });
    };

    $(document).ready(function () {

        // 디테일 정보 가져오기
        getProductDetail()
        function getProductDetail() {
            $.ajax({
                url: "http://192.168.0.231:3000/getProductDetail",
                type: "get",
                data: {
                    "productSeq": productSeq
                },
                success: function (data) {
                    console.log(data);
                    $('#maker').text(data.productMaker);
                    $('#title').text(data.productName);
                    $('p[name=productTitle]').text(data.productName);
                    $('#rating').text(data.productRating);
                    $('#productRating').text(data.productRating);
                    $('#starRating').css('width', (data.productRating*20+2)+'%');
                    $('#starRating2').css('width', (data.productRating*20)+'%');
                    $('#totalPrice').text(data.productDiscount);
                    $('#content').append(data.productContent);

                    if(data.productDiscount != 0) { // 할인상품이라면,
                        $('#costPrice').text(makeComma(data.productPrice)+'원');
                        $('#discountPrice').text(makeComma(data.productDiscount));
                        $('#discountRate').text(discountRate(data.productPrice, data.productDiscount)+'%');
                        $('#point').text(Math.ceil(data.productDiscount*0.01));
                        $('#totalPrice').text(makeComma(data.productDiscount) + '원');
                        $('#totalPrice_side').text(makeComma(data.productDiscount) + '원');
                    } else {
                        $('#discountPrice').text(makeComma(data.productPrice));
                        $('#sellPrice').attr('style', 'margin: 10px;font-size: 27px;margin-left: 180px;color: rgb(0,0,0);margin-top: 10px;padding: 0px;padding-top: 0px;');
                        $('#point').text(Math.ceil(data.productPrice*0.01));
                        $('#totalPrice').text(makeComma(data.productPrice)+'원');
                        $('#totalPrice_side').text(makeComma(data.productPrice)+'원');
                    };

                    $('img[name=productImg]').attr('src', 'http://192.168.0.231:3000/upload/' + data.productFileName);
                    $('#mainImg').attr('src', 'http://192.168.0.231:3000/upload/' + data.productFileName);
                },
                error: function () {
                    alert('getProductDetail() error');
                }
            });
        };


        // 상품 옵션 리스트 가져오기
        getProductOptionList()
        function getProductOptionList() {
            $.ajax({
                url: "http://192.168.0.231:3000/getProductOptionList",
                type: "get",
                data: {
                    "productSeq": productSeq
                },
                success: function (list) {
                    console.log(list);
                    let app = "";
                    let seq = 1;
                    let title = "";
                    for(let i = 0; i < list.length; i++) {
                        
                        if(title != "" && list[i].optionTitle != title) {
                            app += '</select></div></div>';
                            seq++;
                        }

                        if(list[i].optionSeq == 1) {
                            app+=   '<div class="row" style="margin: 0px 0px 7px 9px;">'
                                +        '<div class="col-md-3"><span style="color: rgb(101,101,101);font-family: \'Noto Sans KR\';">'
                                +            '<strong id="selectKey">'+list[i].optionTitle+'</strong>'
                                +        '</span></div>'
                                +    '<div class="col-md-5">'
                                +        '<select name="selectItem_'+seq+'" class="shadow-sm custom-select custom-select-sm"'
                                +            'style=";width: 180px;">';
                        }
                        
                        app += '<option value="'+list[i].optionContent+'">'+list[i].optionContent+'</option>'
                        
                        title = list[i].optionTitle;
                    }

                    app += '</select></div></div>';

                    $("#optionList").append(app);
                    $("#optionList_side").append(app);
                    
                    

                },
                error: function () {
                    alert('getProductOptionList() error');
                }
            });
        };




        // 사이드 결제창 스크롤 따라 이동
        let menuOffset = $('#miniMenu').offset();
        $(window).scroll(function () {

            let position = $(window).scrollTop();
            
            if ($(this).scrollTop() > 800 && $(this).scrollTop() < $(document).height() - 1400) {
                $("#sidebox").css('position', 'fixed');
            }
            else {
                $("#sidebox").css('position', 'relative');
            };

            if ($(this).scrollTop() >= menuOffset.top) {
                $('#miniMenu').addClass('jbFixed');
            } else {
                $('#miniMenu').removeClass('jbFixed');
            }
            
            
        });

        // 이미지 클릭 시 파일 업로드
        
        $('.uploadImg').click(function(e) {
            $('#_target_url').val(document.getElementById('_uploadImg').src);
            e.preventDefault();
            $('#_file').click();
        })
        
    });


    // 미니 네비게이션 스크롤 이동
    $('#contentBtn').click(function() {
        document.querySelector('#content').scrollIntoView({block:"start", behavior:"smooth"});
        $('div[name=miniMenu]').css('border-bottom-color', '');
        $(this).css('border-bottom-color', 'rgb(244,116,76)');
        $(this).css('border-bottom-width', '3px');
        
    })
    $('#reviewBtn').click(function() {
        document.querySelector('#reviewSlide').scrollIntoView({block:"start", behavior:"smooth"});
        $('div[name=miniMenu]').css('border-bottom-color', '');
        $(this).css('border-bottom-color', 'rgb(244,116,76)');
        $(this).css('border-bottom-width', '3px');
    })
    $('#questionBtn').click(function() {
        document.querySelector('#questionSlide').scrollIntoView({block:"start", behavior:"smooth"});
        $('div[name=miniMenu]').css('border-bottom-color', '');
        $(this).css('border-bottom-color', 'rgb(244,116,76)');
        $(this).css('border-bottom-width', '3px');
    })
    $('#deliveryBtn').click(function() {
        document.querySelector('#delivery').scrollIntoView({block:"start", behavior:"smooth"});
        $('div[name=miniMenu]').css('border-bottom-color', '');
        $(this).css('border-bottom-color', 'rgb(244,116,76)');
        $(this).css('border-bottom-width', '3px');
    })





    let elements = $('#reviewModal.modal-overlay, .modal');

    // 리뷰 모달창 버튼
    $(document).on('click', '#reviewWriteBtn', function(){

        $.ajax({
            url: "http://192.168.0.231:3000/getUserPurchase",
            type: "get",
            data: {
                "productSeq": productSeq,
                "userSeq": userSeq
            },
            success: function (data) {
                console.log(data);

                // 구매한 물품이 아닌 경우 리뷰 못쓰게 막는다.
                if(data=="") {
                    alert('구매 후에 리뷰 작성이 가능합니다.');
                    return;
                }

                let opValue = JSON.parse(data.selectOption);
                $('#purchaseSeq').val(data.purchaseSeq);
                $('#reviewProductSeq').val(productSeq);
                $('#reviewUserSeq').val(userSeq);
                $('#productCount').text(data.quantity);

                elements.addClass('active');
            },
            error: function(){
            }
        });
        
    });
    
    $('.close-modal').click(function(){
        elements.removeClass('active');
    });

    // 리뷰 작성 완료 버튼
    $('.review_write_btn').click(function() {

        $.ajax({
            url: "http://192.168.0.231:3000/addProductReview",
            type: "post",
            data: new FormData($('#upload_frm')[0]),
            enctype:"multipart/form-data",
            processData:false,
            contentType:false,
            cache:false,
            success: function (data) {
                console.log(data)
                if (data == "suc") {
                    alert("리뷰가 성공적으로 작성되었습니다.");
                    getProductDetail();
                    getProductReviewList(0);
                    elements.removeClass('active');
                } else {
                    console.log('리뷰 작성 실패');
                }
            },
            error: function () {
                alert('addProductReview error');
            }
        });
    });



    // 파일 업로드 이미지 미리보기
    let sel_file;
    $(document).on('change', '#_file', function(e) {
        let files = e.target.files;
        let filesArr = Array.prototype.slice.call(files);

        filesArr.forEach(function(f) {
            if(!f.type.match("image.*")) {
                alert('이미지 확장자만 가능합니다. ');
                return;
            }

            sel_file = f;

            let reader = new FileReader();
            reader.onload = function(e) {
                $('#_uploadImg').attr("src", e.target.result);
            }
            reader.readAsDataURL(f);
        })
    });


    // 리뷰 리스트 가져오기
    getProductReviewList(0);
    function getProductReviewList(pageNum) {
        $.ajax({
            url: "http://192.168.0.231:3000/getProductReviewList",
            type: "post",
            data: {
                "productSeq": productSeq,
                "productRevPageNum": pageNum
            },
            success: function (list) {
                console.log(list);

                let app = "";

                $('#productReview').children().remove();

                if (Object.keys(list).length == 0) {

                    app += '<div class="reviews" style="width: 600px; margin-right: 50px;">'
                        + '<h3 style="font-size: 16px; margin-top: 30px;">작성된 후기가 없습니다. 첫번째 후기를 남겨주세요! <br><br></h3>'
                        + "</div>";

                    $("#productReview").append(app);

                } else {
                    $.each(list, function (i, val) {
                        app += '<div class="row" style="padding-top: 18px;padding-left: 0px;padding-bottom: 20px;border-bottom: 1px solid rgb(150,150,150) ;">'
                            +        '<div class="col">'
                            +            '<div class="row">'
                            +                '<div class="col"><span style="font-size: 18px; color:rgb(244,116,76);">';

                        for(let i=0; i<5; i++) {
                            if(i < val.productRevRating) {
                                app += '★';
                            } else {
                                app += '☆';
                            }
                        };

                        app +=                   '</span><span style="margin-left: 10px;font-size: 15px;">'+val.nickname+'</span>'
                            +                    '<span style="margin-left: 5px;">&nbsp;·&nbsp;</span>'
                            +                    '<span style="margin-left: 10px;font-size: 13px;">'+val.productRevDate.substring(0,10)+'</span>'
                            +                '</div>'
                            +            '</div>'
                            +            '<div class="row">'
                            +                '<div class="col" style="margin: 25px 0px;">'
                            +                    '<span style="font-size: 14px;">'+val.productRevContent+'</span>'
                            +                '</div>'
                            +            '</div>'
                            +            '<div class="row">'
                            +                '<div class="col"><a href="http://192.168.0.231:3000/upload/'+val.productRevFileName+'" data-toggle="lightbox" data-gallery="example-gallery"><img class="reviewImg" src="http://192.168.0.231:3000/upload/'+val.productRevFileName+'" width="130px" style="border-radius: 10px;"></a></div>'
                            +            '</div>'
                            +        '</div>'
                            +    '</div>';
                    });
                    $('#productReview').append(app);
                };    

            },
            error: function(){
            }
        });
    };


    // 리뷰 총 수 가져오기
    getProductReviewCount()
    function getProductReviewCount() {

        $.ajax({
            url: "http://192.168.0.231:3000/getProductReviewCount",
            type: "get",
            data: {
                "productSeq": productSeq
            },
            success: function (totalCount) {
                console.log(totalCount);
                $('span[name=reviewCount]').text(totalCount);
                loadPage(totalCount);
            },
            error: function () {
                alert('getProductReviewCount() error');
            }
        });

    };

    //리뷰 사진 클릭 시 원본 사진 보여주기
    $(document).on('click', '[data-toggle="lightbox"]', function(event) {
        event.preventDefault();
        $(this).ekkoLightbox();
    });
    


    // 리뷰 페이징 처리
    function loadPage(totalCount) {

        let pageSize = 4;
        let nowPage = 1;
        let _totalPages = Math.floor(totalCount / pageSize);
        if (totalCount % pageSize > 0) {
            _totalPages++;
        }

        $("#pagination").twbsPagination('destroy');	// 데이터가 갱신되면 페이징 갱신


        $("#pagination").twbsPagination({
            //	startPage: 1,
            totalPages: _totalPages,
            visiblePages: 10,
            first: '<span aria-hidden="true">«</span>',
            prev: false,
            next: false,
            last: '<span aria-hidden="true">»</span>',
            initiateStartPageClick: false,		// onPageClick 자동 실행되지 않도록 한다
            onPageClick: function (event, page) {
                nowPage = page;
                getProductReviewList(page-1);
            },
        });

    };



    let elements_qna = $('#qnaModal.modal-overlay, .modal');

    // 문의 모달창 버튼
    $(document).on('click', '#qnaWriteBtn', function(){
        if(userSeq==undefined) {
            alert('로그인 이후 작성이 가능합니다.');
            return;
        }
        elements_qna.addClass('active');
    });


    // 문의 작성 완료 버튼
    $('.qna_write_btn').click(function() {

        $.ajax({
            url: "http://192.168.0.231:3000/addProductQnA",
            type: "post",
            data: {
                userSeq: userSeq,
                productSeq: productSeq,
                productQContent: $('#qnaContent').val()
            } ,
            success: function (data) {
                console.log(data)
                if (data == "suc") {
                    alert("문의글이 작성되었습니다.");
                    //getProductQnAList(0);
                    elements_qna.removeClass('active');
                } else {
                    console.log('문의글 작성 실패');
                }
            },
            error: function () {
                alert('addProductQnA error');
            }
        });
    });



    // 문의 리스트 가져오기
    getProductQnAList(0);
    function getProductQnAList(pageNum) {
        $.ajax({
            url: "http://192.168.0.231:3000/getProductQnAList",
            type: "post",
            data: {
                "productSeq": productSeq,
                "productQnAPageNum": pageNum
            },
            success: function (list) {
                console.log(list);

                let app = "";

                $('#productQnA').children().remove();

                if (Object.keys(list).length == 0) {

                    app += '<div class="reviews" style="width: 600px; margin-right: 50px;">'
                        + '<h3 style="font-size: 16px; margin-top: 30px;">작성된 문의가 없습니다.<br><br></h3>'
                        + "</div>";

                    $("#productQnA").append(app);

                } else {
                    $.each(list, function (i, val) {
                        app += 
                            '<div class="row" style="padding-top: 0px;padding-bottom: 20px;">'
                            +    '<div class="col">'
                            +        '<div class="row">'
                            +            '<div class="col">';
                            
                            
                        if(val.productAContent != null) {
                            app += '<span style="font-size: 13px;color: rgb(244,116,76);"><strong>답변완료</strong>';
                        } else {
                            app += '<span style="font-size: 13px;color: rgb(255, 164, 137);"><strong>답변대기</strong>';
                        }        
                                
                        app +=       '</span><span>&nbsp;'
                            +                    '│&nbsp;&nbsp;</span><span style="font-size: 14px;">'+val.nickname+'</span><span>&nbsp;'
                            +                    '·&nbsp;&nbsp;</span><span style="font-size: 12px;">';
                        
                        if(val.purchaseSeq > 0) {
                            app += "구매"
                        } else {
                            app += "비구매"
                        }
                                
                                
                        app +=       '</span><span>&nbsp;'
                            +                    '·&nbsp;&nbsp;</span><span style="font-size: 12px;">'+timeForToday(val.productQnADate)+'</span></div>'
                            +        '</div>'
                            +        '<div class="row" style="border-bottom: 1px solid rgb(180,180,180) ;">'
                            +            '<div class="col">'
                            +                '<div class="row">'
                            +                    '<div class="col-lg-10"><span style="font-size: 15px;"><br>'+val.productQContent+'<br></span>'
                            +                    '</div>';
                        if(val.productAContent == null) {
                            app +=  '</div><div class="row"style="margin-top: 15px;"><div>';
                        }
                        else {
                            app +=  '<div class="col-lg-2 col-xl-2 text-center">'
                                +        '<div><a class="btn" data-toggle="collapse" aria-expanded="false" aria-controls="collapse-1"'
                                +             'href="#collapse-'+i+'" role="button" style="margin-top: 10px;font-size: 20px;"><strong>∨</strong></a>'
                                +        '</div>'
                                +    '</div>'
                                + '</div>'
                                + '<div class="row" style="background-color: #e6e6e6; margin-top: 10px; border-radius: 10px;">'
                                +      '<div class="col-lg-10">'
                                +            '<div class="collapse" id="collapse-'+i+'">'
                                +                 '<p style="margin-top: 10px; color: grey;">└ 답변</p>'
                                +                 '<p style="margin-top: 5px; margin-left: 20px;">'+val.productAContent+'</p>'
                                +            '</div>'
                                +      '</div>'
                                + '</div>';
                        }
                                                


                        app +=             '</div>'
                            +        '</div>'
                            +    '</div>'
                            +'</div>';
                    });
                    $('#productQnA').append(app);
                };    

            },
            error: function(){
            }
        });
    };


    

    // 문의 총 수 가져오기
    getProductQnACount()
    function getProductQnACount() {

        $.ajax({
            url: "http://192.168.0.231:3000/getProductQnACount",
            type: "get",
            data: {
                "productSeq": productSeq
            },
            success: function (totalCount) {
                console.log(totalCount);
                $('span[name=qnaCount]').text(totalCount);
                loadPageQnA(totalCount);
            },
            error: function () {
                alert('getProductQnACount() error');
            }
        });

    };


    
    // 문의 페이징 처리
    function loadPageQnA(totalCount) {

        let pageSize = 4;
        let nowPage = 1;
        let _totalPages = Math.floor(totalCount / pageSize);
        if (totalCount % pageSize > 0) {
            _totalPages++;
        }

        $("#pagination_qna").twbsPagination('destroy');	// 데이터가 갱신되면 페이징 갱신


        $("#pagination_qna").twbsPagination({
            //	startPage: 1,
            totalPages: _totalPages,
            visiblePages: 10,
            first: '<span aria-hidden="true">«</span>',
            prev: false,
            next: false,
            last: '<span aria-hidden="true">»</span>',
            initiateStartPageClick: false,		// onPageClick 자동 실행되지 않도록 한다
            onPageClick: function (event, page) {
                nowPage = page;
                getProductQnAList(page-1);
            },
        });

    };


    


    // 문의글 시간 나타내기
    function timeForToday(value) {
        const today = new Date();
        const timeValue = new Date(value);

        const betweenTime = Math.floor((today.getTime() - timeValue.getTime()) / 1000 / 60);
        if (betweenTime < 1) return '방금 전';
        if (betweenTime < 60) {
            return `${betweenTime}분 전`;
        }

        const betweenTimeHour = Math.floor(betweenTime / 60);
        if (betweenTimeHour < 24) {
            return `${betweenTimeHour}시간 전`;
        }

        const betweenTimeDay = Math.floor(betweenTime / 60 / 24);
        if (betweenTimeDay < 365) {
            return `${betweenTimeDay}일 전`;
        }

        return `${Math.floor(betweenTimeDay / 365)}년 전`;
    }




    </script>
</body>
</html>