<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>완벽한 자취생활, 완자</title>

<link rel="shortcut icon" href="../../assets/img/wanza-Icon.ico" type="image/x-icon"> <!-- 브라우저 탭 아이콘 -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css"> <!-- 폰트어썸아이콘 -->
<!-- <link rel="stylesheet" type="text/css" href="../../assets/bootstrap/css/bootstrap.min.css"> -->
<!-- 부트스트랩 -->
<link rel="stylesheet" type="text/css" href="../../css/style.css"> <!-- 공통-->

<style>
#order .row{
    margin: 20px 0;
}
/* 왼쪽 주문정보 창 */
#order{
    font-size: 12pt;
}
.order_title_head{
    margin: 20px 0 50px 0;
}
.order_title{
    margin: 20px 0;
    padding: 20px 20px 20px 0;
    border-bottom: solid #dbdbdb;
    font-weight: bold;
    font-size: 17pt;
}
.order_content_wrap{
    height: 40px;
    align-items: center;
    margin: 20px 0;
}
.order_subtitle{
    width: 100px;
    height: 100%;
    display: inherit;
    align-items: center;
}
.order_content{
    height: 100%;
}
.order_content label{
    margin: 0;
    width: 300px;
    height: 100%;
    border: solid 0.5px #dbdbdb;
    border-radius: 4px;
    align-items: center;
    vertical-align: middle;
}
/* 셀렉 인풋 폼 */
.order_content select,
.order_content input{
    border: none;
    background-color: transparent;
    height: 100%;
    width: 100%;
    padding: 0 10px;
}
.order_content select:focus,
.order_content input:focus{
    outline: none;
    box-shadow: 0 0 2px 0.3px #f4744c;
}
/* 폰 */
.order_phone1 label{
    width: 80px;
}
.order_phone2 label{
    width: 210px;
}
/* 셀렉박스 기본 기호 지우기 */
select{
    -webkit-appearance: none;
    -moz-appearance: none;
    appearance: none;
}
select::-ms-expand{
    display: none;
}
.order_phone1 i{
    position: relative;
    top: 3px; left: -20px;
    z-index: -1;
}

/* 이메일 */
.order_email1 label{
    width: 150px;
    margin-right: 5px;
}
.order_email2 label{
    width: 125px;
    margin-left: 5px;
}
.order_email2 i{
    position: relative;
    top: 3px; left: -18px;
    z-index: -1;
}


/* 배송지 탭 */
#order .nav-tabs{
    margin: 40px 0;
}
#order .nav-tabs .nav-link{
    border: none;
    margin-bottom: 0;
}
#order .nav-link.active+.nav-line,
#order .nav-link.active{
    font-weight: bold;
    color: #212529;
    border-bottom: solid #f4744c;
    width: 100%;
    margin-bottom: -2px;
}
#order .nav-tabs a{
    color: #212529;
}
/* 배송지 */
.order_dlvy_name label{
    width: 150px;
}
.order_dlvy_name i{
    position: relative;
    top: 3px; left: -18px;
    z-index: -1;
}
.dlvy{height: 88px;}
.dlvy1>div:first-of-type,
.dlvy div:first-of-type{
    align-items: flex-start;
    padding-top: 8px;
}
/* .dlvy1 label{height: 39.5px;} */
.dlvy1 select,
.dlvy1 input{
    height: 39px;
}
.dlvy_req,
.dlvy_address{
    display: inherit;
    flex-direction: column;
}

.dlvy_address label:first-of-type{
    margin-bottom: 8px;
}
/* 요청사항 */
#_dlvy_req3{margin-bottom: 10px;}
.dlvy1{
    margin-bottom: 100px;
}
.dlvy_req label{
    width: 300px;
}
.dlvy_req1{
    display: flex;
}
.dlvy_req1 select{
    margin-right: -10px;
}
.dlvy_req i{
    position: relative;
    top: 0px; left: -10px;
    z-index: -1;
}
.textlimit{
    position: relative;
    color: #dbdbdb;
    left: 250px;
    bottom: 20px;
    height: 0;
}

/* 기본 배송지 설정 버튼 */
.defalutAddress_btn{
    width: 170px;
    height: 39px;
    margin: 10px;
    border-radius: 5px;
    color: #f4744c;
    border: 0.5px solid #f4744c;
    background-color: transparent;
    font: 1em bold;
}
.defalutAddress_btn:hover{
    color: white;
    background-color: #f4744c;
    border: 0.5px solid #f4744c;
}

/* 기본 배송지 설정 버튼 */
.addressSearchBtn{
    width: 100px;
    height: 39px;
    margin: 10px 10px 60px 10px;
    border-radius: 5px;
    color: #f4744c;
    border: 0.5px solid #f4744c;
    background-color: transparent;
    font: 1em bold;
}
.addressSearchBtn:hover{
    color: white;
    background-color: #f4744c;
    border: 0.5px solid #f4744c;
}


/* 배송지 저장버튼 */
.dlvy_btn{
    width: 40%;
    height: 50px;
    margin: 10px 30%;
    border-radius: 5px;
    color: white;
    border: none;
    background-color: #f4744c;
    font: 1.2em bold;
}
.dlvy_btn:hover{
    color: #f4744c;
    background-color: white;
    border: 0.5px solid #f4744c;
}

/* 포인트 */
#point .point{
    color: #f4744c;
    font-size: 14pt;
    font-weight: bold;
}
#point .point_box label{
    width: 200px;
}
.point_btn{
    width: 90px;
    height: 39px;
    margin: 10px;
    border-radius: 5px;
    color: #f4744c;
    border: 0.5px solid #f4744c;
    background-color: transparent;
    font: 1em bold;
}
.point_btn:hover{
    background-color: #fdf2f0;
}
.point_btn.active{
    color: white;
    border: none;
    background-color: #f4744c;
}

/* 결제수단 */
.pay_use_wrap{
    display: flex;
    color: #f4744c;
}
.pay_use{
    width: 90px;
    height: 90px;
    margin: 0 20px 0 0;
    display: inherit;
    justify-content: center;
    align-items: center;
    border: solid 3px;
    border-radius: 7px;
}
.pay_use label{
    margin: 0;
    width: 91px;
    height: 91px;
    text-align: center;
    line-height: 8;
}
.pay_use input{
    visibility: hidden;
    width: 0; height: 0;
}
.pay_use:hover{
    background-color: #fdf2f0;
    border-radius: 7px;
}
.pay_use.active{
    color: white;
    border: none;
    background-color: #f4744c;
    /* border-radius: 7px; */
}



/* 오른쪽 결제 창 */
.payment_wrap{
    margin: 10px;
    position: sticky;
    top: 20px;
}
.payment_box{
    border: 0.6px solid #dbdbdb;
    border-radius: 4px;
    padding: 10px;
}
.payment1{
    border-bottom: solid #dbdbdb;
}
#payment .payment1_0{
    margin: 20px 10px;
    justify-content: space-between;
}
.pa_bo h4{ /*글씨 굵게*/
    font-weight: 900;
}
.pay_terms{
    padding: 30px 0;
    font-size: 11pt;
    display: flex;
    justify-content: flex-start;
    align-items: center;
    line-height: 20px;
}

/* 망할 체크박스 색 바꾸기 */
#payment .custom-checkbox{
    margin-left: 30px;
}
#payment .custom-control-label::before,
#payment .custom-control-label::after{
    top: 0rem; left: -1.8rem;
    width: 1.3rem; height: 1.3rem;
}
#payment .custom-control-input:checked~.custom-control-label::before {
    color: #fff;
    border-color: #f4744c;
    background-color: #f4744c;
}
#payment .custom-control-input:focus~.custom-control-label::before {
    box-shadow: none;   /* 0 0 0 .2rem rgba(0,123,255,.25) */
}
#payment .custom-control-input:focus:not(:checked)~.custom-control-label::before {
    border-color: #adb5bd
}
#payment .custom-control-input:not(:disabled):active~.custom-control-label::before {
    color: #fff;
    background-color: #ffe4db;
    border-color: #ffe4db;
}

/* 약관 보기 */
.pay_terms a{
    color: black;
    font-weight: bold;
    text-decoration: underline;
    margin: 0 10px;
    height: 20px;
    min-width: 30px;
}
/* 결제 버튼 */
.payment_btn{
    width: 100%;
    height: 50px;
    margin: 10px 0;
    border-radius: 5px;
    color: white;
    border: none;
    background-color: #f4744c;
    font: 1.2em bold;
}
.payment_btn:hover{
    color: #f4744c;
    background-color: white;
    border: 0.5px solid #f4744c;
}


/* 약관 modal */
@media only screen and (min-width: 40em) {
    #termsModal.modal-overlay {
        display: flex;
        align-items: center;
        justify-content: center;
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        z-index: 5;
        background-color: rgba(0, 0, 0, 0.6);
        opacity: 0;
        visibility: hidden;
        -webkit-backface-visibility: hidden;
        backface-visibility: hidden;
        transition: opacity 0.6s cubic-bezier(0.55, 0, 0.1, 1), visibility 0.6s cubic-bezier(0.55, 0, 0.1, 1);
    }
    #termsModal.modal-overlay.active {
        opacity: 1;
        visibility: visible;
    }
}
/**
* Modal
*/
#termsModal .modal_terms {
    display: flex;
    align-items: center;
    justify-content: center;
    position: relative;
    margin: 0 auto;
    background-color: rgba(255, 255, 255, 0.267);
    width: 520px;
    max-width: 75rem;
    height: 750px;
    padding: 1.2rem;
    border-radius: 3px;
    opacity: 0;
    overflow-y: auto;
    visibility: hidden;
    box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
    -webkit-backface-visibility: hidden;
    backface-visibility: hidden;
    transform: scale(1.2);
    transition: all 0.6s cubic-bezier(0.55, 0, 0.1, 1);
}
#termsModal .modal_terms .close-modal {
    position: absolute;
    cursor: pointer;
    top: 5px;
    right: 15px;
    opacity: 0;
    -webkit-backface-visibility: hidden;
    backface-visibility: hidden;
    transition: opacity 0.6s cubic-bezier(0.55, 0, 0.1, 1), transform 0.6s cubic-bezier(0.55, 0, 0.1, 1);
    transition-delay: 0.3s;
}
#termsModal .modal_terms .close-modal svg {
    width: 1.75em;
    height: 1.75em;
}
#termsModal .modal_terms .modal-content {
    opacity: 0;
    -webkit-backface-visibility: hidden;
    backface-visibility: hidden;
    transition: opacity 0.6s cubic-bezier(0.55, 0, 0.1, 1);
    transition-delay: 0.3s;
    background-color: rgb(255, 255, 255);
    padding: 30px;
}
#termsModal .modal_terms.active {
    visibility: visible;
    opacity: 1;
    transform: scale(1);
}
#termsModal .modal_terms.active .modal-content {
    opacity: 1; 
}
#termsModal .modal_terms.active .close-modal {
    transform: translateY(10px);
    opacity: 1;
}

/**
* Mobile styling
*/
@media only screen and (max-width: 39.9375em) {

    #termsModal .modal_terms {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        -webkit-overflow-scrolling: touch;
        border-radius: 0;
        transform: scale(1.1);
        padding: 0 !important;
    }
    
    #termsModal .close-modal {
        right: 20px !important;
    }
}

</style>

</head>
<body>
    <header include-html="../commons/header.html"></header>
    <nav include-html="../commons/menuComm.html"></nav>

    <!-- 약관 모달 -->
    <div id="termsModal" class="modal-overlay">
        <div class="modal_terms">
        <a class="close-modal">
            <svg viewBox="0 0 20 20">
            <path fill="#000000" d="M15.898,4.045c-0.271-0.272-0.713-0.272-0.986,0l-4.71,4.711L5.493,4.045c-0.272-0.272-0.714-0.272-0.986,0s-0.272,0.714,0,0.986l4.709,4.711l-4.71,4.711c-0.272,0.271-0.272,0.713,0,0.986c0.136,0.136,0.314,0.203,0.492,0.203c0.179,0,0.357-0.067,0.493-0.203l4.711-4.711l4.71,4.711c0.137,0.136,0.314,0.203,0.494,0.203c0.178,0,0.355-0.067,0.492-0.203c0.273-0.273,0.273-0.715,0-0.986l-4.711-4.711l4.711-4.711C16.172,4.759,16.172,4.317,15.898,4.045z"></path>
            </svg>
        </a>
        <div class="modal-content">
                <div>
                    <div class="row" style="margin-bottom: 10px;">
                        <div class="col" style="margin-top: 20px; margin-bottom: 1px;">
                            <p style="font-size: 20px; font-weight: bold;">주문 및 결제 약관 동의</p>
                        </div>
                    </div>
                    <hr>
                    <div class="row" style="margin-top: 25px; margin-bottom: 10px;">   
                        <div class="col">
                            <textarea id="termsContent" style="width: 420px; height: 420px; resize: none; background-color: #ececec; border: none; border-radius: 8px; padding: 15px;" readonly include-html="../commons/terms.html"></textarea>
                        </div>
                    </div> 
                    <hr>
                </div>
            </form>
        </div>
        </div>
    </div>
    <!-- 약관 모달 end -->
    
    <form action="" id="form_order">

        <input type="hidden" id="_howPayment" name="howPayment">
        <input type="hidden" id="_productSeq" name="productSeq">
        <input type="hidden" id="_selectOption" name="selectOption">
        <input type="hidden" id="_quantity" name="quantity">
        <input type="hidden" id="_price" name="price">

        <input type="hidden" id="_userSeq" name="userSeq">
        <input type="hidden" id="_productAmount" name="productAmount">
        <input type="hidden" id="_totalAmount" name="totalAmount">
        <input type="hidden" id="_deliveryAmount" name="deliveryAmount">
    <div class="container mt-5">
        <div class="row" style="height: 100%;">
            <div class="col-md-8" id="order">
                <div class="order_title_head"><h1>주문결제</h1></div>

                <div class="mb-5">
                    <div class="order_title"><span>주문자</span></div>
                    <div>
                        <div class="row order_content_wrap">
                            <div class="order_subtitle">이름</div>
                            <div class="order_content"><label for="_name"><input type="text" id="_name" name="name" value=""></label></div>
                        </div>
                        <div class="row order_content_wrap">
                            <div class="order_subtitle">연락처</div>
                            <div class="order_content order_phone1" style="margin-right: 10px;">
                                <label for="_phone1">
                                <input type="text" name="phone1" id="_phone1" readonly>                                    
                            </div>
                            <div class="order_content order_phone2"><label for="_phone2"><input type="text" id="_phone2" name="phone2" value="" readonly></label></div>
                        </div>
                        <div class="row order_content_wrap">
                            <div class="order_subtitle">이메일</div>
                            <div class="order_content order_email1"><label for="_email1"><input type="text" name="email1" id="_email1" value="" readonly></label></div>
                            <span>@</span>
                            <div class="order_content order_email2"><label for="_email2">
                                <input type="text" name="email2" id="_email2" readonly>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="mb-5">
                    <div class="order_title"><span>배송지</span></div>
                    <!-- 탭 -->
                    <ul class="nav nav-tabs">
                        <li class="nav-item">
                            <a id="nav-link-select" class="nav-link active" data-toggle="tab" href="#dlvy_select">배송지선택</a>
                            <div class="nav-line"></div>
                        </li>
                        <li class="nav-item">
                            <a id="nav-link-new" class="nav-link" data-toggle="tab" href="#dlvy_new">신규배송지</a>
                            <div class="nav-line"></div>
                        </li>
                    </ul>
                    <!-- 탭내용 -->
                    <div class="tab-content">
                        <div class="tab-pane fade show active" id="dlvy_select">
                            <div class="row order_content_wrap">
                                <div class="order_subtitle">배송지 이름</div>
                                <div class="order_content order_dlvy_name"><label for="_dlvy_name">
                                    <select name="addressSeq" id="_dlvy_name">
                                    </select></label><i class="fas fa-sort"></i>
                                </div>
                                <div><button type="button" class="defalutAddress_btn">기본 배송지로 설정</button></div>
                            </div>
                            <div class="row order_content_wrap dlvy">
                                <div class="order_subtitle">주소</div>
                                <div class="order_content dlvy_address">
                                    <label for="_dlvy_address1"><input type="text" id="_dlvy_address1" name="dlvy_address1" value=""></label>
                                    <label for="_dlvy_address2"><input type="text" id="_dlvy_address2" name="dlvy_address2" value=""></label>
                                </div>
                            </div>
                            <div class="row order_content_wrap">
                                <div class="order_subtitle">받는사람</div>
                                <div class="order_content"><label for="_name"><input type="text" id="_rname" name="rname" value=""></label></div>
                            </div>
                            <div class="row order_content_wrap">
                                <div class="order_subtitle">연락처</div>
                                <div class="order_content"><label for="_name"><input type="text" id="_rphone" name="rphone" value=""></label></div>
                            </div>
                            <div class="row order_content_wrap dlvy1">
                                <div class="order_subtitle">요청사항</div>
                                <div class="order_content dlvy_req">
                                    <div id="_dlvy_req3">
                                        <label for="_dlvy_req2">
                                        <input type="text" id="_dlvy_req2" name="orderMessage_free" placeholder="배송요청사항을 입력해주세요" value="">
                                        <div class="textlimit">0/20</div></label>
                                    </div>
                                    <label class="dlvy_req1" for="_dlvy_req1">
                                    <select name="orderMessage" id="_dlvy_req1">
                                        <option value="0">배송시 요청사항을 선택해주세요</option>
                                        <option value="부재시 문앞에 놓아주세요">부재시 문앞에 놓아주세요</option>
                                        <option value="배송 전에 미리 연락주세요">배송 전에 미리 연락주세요</option>
                                        <option value="부재시 경비실에 맡겨주세요">부재시 경비실에 맡겨주세요</option>
                                        <option value="4">직접입력</option>
                                    </select><i class="fas fa-sort"></i></label>
                                    
                                </div>
                            </div>
                        </div> <!--배송지 선택 끝-->
                        <!-- 신규배송지 -->
                        <div class="tab-pane" id="dlvy_new">
                            <form id="form_new_dlvy">
                            <div class="row order_content_wrap">
                                <div class="order_subtitle">배송지 이름</div>
                                <div class="order_content"><label for="_name"><input type="text" id="receiveTitle" placeholder="ex) 집, 회사"></label></div>
                            </div>
                            <div class="row order_content_wrap dlvy">
                                <div class="order_subtitle">주소</div>
                                <div class="order_content dlvy_address">
                                    <label for="_dlvy_address1"><input type="text" id="receiveAddress1" placeholder="주소"></label>
                                    <label for="_dlvy_address2"><input type="text" id="receiveAddress2" placeholder="상세 주소"></label>
                                </div>
                                <div>
                                    <input type="button" class="addressSearchBtn" onclick="execDaumPostcode()" value="주소 검색">
                                </div>
                            </div>
                            <div class="row order_content_wrap">
                                <div class="order_subtitle">받는사람</div>
                                <div class="order_content"><label for="_name"><input type="text" id="receiveUser" placeholder="이름"></label></div>
                            </div>
                            <div class="row order_content_wrap">
                                <div class="order_subtitle">연락처</div>
                                <div class="order_content"><label for="_name"><input type="text" id="receivePhone" placeholder="휴대폰 번호"></label></div>
                            </div>
                            <button class="dlvy_btn" type="button">저 장</button>
                            </form>
                        </div>
                    </div> <!--탭 컨탠츠 끝-->
                </div>

                <div class="mb-5">
                    <div class="order_title"><span>주문상품</span></div>
                    <div>
                        <div id="itemList">                           
                        </div>                        
                        <!--
                        <div class="row" style="margin: 20px 0px;padding-bottom: 20px; border-bottom: 1px solid rgb(129, 129, 129); display: flex; align-items:center;">
                            <div class="col" style="text-align: center;"><img id="itemImg" style="width: 130px; height: 130px;" alt=""></div>
                            <div class="col-md-6">
                                <div class="row">
                                    <div class="col offset-md-1">
                                        <p id="itemMaker" style="font-size: 12px;">리샘가구</p>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col offset-md-1">
                                        <h5 id="itemTitle">OFFICY 서랍장 4.1단</h5>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col offset-md-1" style="font-size: 15px; color: #707070;">
                                        <span>색상</span><span>&ensp;</span><span id="selectItem">월넛</span>
                                    </div>
                                </div>
                            </div>
                            <div class="col">
                                <p id="itemCount">개</p>
                            </div>
                            <div class="col">
                                <p id="itemPrice">원</p>
                            </div>
                        </div>
                        -->


                        
                        <div class="row" style="height: 70px; background-color: #cecece; border-bottom: 1px solid rgb(182, 181, 181); display: flex; align-items:center;">
                            <div style="margin-left: 200px;">
                                <span>상품금액&ensp;</span><span id="allItemPrice"></span><span>원&ensp;+&ensp;배송비&ensp;</span><span id="deliveryCharge">2,500원</span><span>&ensp;=&ensp;</span><span><b>주문금액&ensp;</b> </span><span id="orderPrice" style="font-size: 21px; font-weight: bold;">0원</span>
                            </div>
                        </div>
                    </div>
                </div>


                <div class="mb-5" id="point" >
                    <div class="order_title"><span>포인트</span></div>
                    <div class="row order_content_wrap">
                        <div class="order_content point_box">
                            <label for="_point">
                                <input type="text" id="_point" name="useMileage" placeholder="0">
                            </label>
                        </div>
                        <div><button class="point_btn" type="button">전액사용</button></div>
                    </div>
                    <div id="usePoint" class="row" style="margin: 0px;">
                        <div class="order_subtitle">사용포인트</div>
                        <div id="_usePoint" class="order_subtitle point">p</div>
                    </div>
                    <div class="row order_content_wrap" style="margin: 0px;">
                        <div class="order_subtitle">보유포인트</div>
                        <div id="myPoint" class="order_subtitle point">p</div>
                    </div>
                </div>

                <div class="mb-5">
                    <div class="order_title"><span>결제수단</span></div>

                    <div class="pay_use_wrap">
                        <div class="pay_use">
                            <label for="pay_card"><i class="far fa-credit-card fa-4x"></i></label>
                            <input type="radio" id="pay_card" name="amountType" value="card">
                        </div>
                        <div class="pay_use">
                            <label for="pay_cash"><i class="fas fa-won-sign fa-4x"></i></label>
                            <input type="radio" id="pay_cash" name="amountType" value="trans">
                        </div>
                        <div class="pay_use">
                            <label for="pay_mobile" class=""><i class="fas fa-mobile-alt fa-4x"></i></label>
                            <input type="radio" id="pay_mobile" name="amountType" value="phone">
                        </div>
                    </div>
                </div>
                </form>
            
            </div> <!-- 왼쪽 부분 끝 -->
            
            <div class="col-md-4 p-1" id="payment">
                <div class="payment_wrap">
                    
                    <div class="payment_box">
                        <div class="payment1">
                            <div class="row payment1_0"><span>총 상품금액</span><span id="sideTotalPrice">원</span></div>
                            <div class="row payment1_0"><span>배송비</span><span id="sideDeliveryCharge">원</span></div>
                            <div class="row payment1_0"><span>포인트 사용</span><span id="sideUsePoint">0 원</span></div>
                        </div>

                        <div class="payment1">
                            <div class="row payment1_0 pa_bo"><span><h4>총 결제금액</h4></span><span><h4 id="sideResultPrice">0원</h4></span></div>
                            <div class="row payment1_0"><span>적립포인트</span><span id="sideGetPoints">p</span></div>                        
                        </div>

                        <span class="pay_terms"><div class="custom-checkbox "><input type="checkbox" id="cb" class="custom-control-input">
                            <label for="cb" class="custom-control-label"></label></div>
                            [필수] 주문 및 결제 관련 약관 동의<a id="pay_terms" href="#none"> 보기</a></span>

                    </div>
                    <button id="sidePaymentBtn" class="payment_btn" type="button" >0원 결제하기</button>
                    <button id="testBtn" class="btn btn-primary" type="button" >결제창생략 임시버튼</button>
                </div>
            </div>
        </div>
    </div>


    <footer include-html="../commons/footer.html"></footer>

</body>

<script src="../../assets/js/jquery.min.js"></script>
<script src="../../assets/bootstrap/js/bootstrap.min.js"></script>
<script src="../../js/includeHTML.js"></script>
<script src="../../js/header.js"></script>
<script src="../../js/slang.js"></script>
<script src="//t1.daumcdn.net/mapjsapi/bundle/postcode/prod/postcode.v2.js"></script>
<script src="//dapi.kakao.com/v2/maps/sdk.js?appkey=d9229def17f744d57603391f713d5651&libraries=services"></script>
<!-- iamport.payment.js -->
<script type="text/javascript" src="https://cdn.iamport.kr/js/iamport.payment-1.1.5.js"></script>

<script>

//파라미터값 가져오도록 하는 함수
function getParameter(name) {
    name = name.replace(/[\[]/, "\\[").replace(/[\]]/, "\\]");
    var regex = new RegExp("[\\?&]" + name + "=([^&#]*)"),
        results = regex.exec(location.search);
    return results === null ? "" : decodeURIComponent(results[1].replace(/\+/g, " "));
}
let seq = getParameter("seq");
let selectItem = getParameter("selectItem");
let itemCount = getParameter("itemCount");
let direct = getParameter("directPayment");


// 옵션 값 JSON 형식으로 변환
let optionTitleParam = "";
let num = 1;
let oppArr = new Array();
while(getParameter("optionTitle"+num) != "") {
    let object = new Object();
    object.opTitle = getParameter("optionTitle"+num);
    object.opContent = getParameter("optionContent"+num);
    oppArr.push(object);
    num++;
}


$('#_productSeq').val(seq);
//$('#_selectOption').val(JSON.stringify(oppArr));
$('#_quantity').val(itemCount);


//로그인한 계정 닉네임 가져오기
let sessionId = JSON.parse(sessionStorage.getItem("login"));
if (sessionId == null) {
    sessionId = '';
};

// 금액 콤마 삽입 정규식
function makeComma(str) {

    str = String(str);
    return str.replace(/(\d)(?=(?:\d{3})+(?!\d))/g, '$1,');
};

let element = document.getElementById('order'); //왼쪽 창 높이 구하기
let h = element.clientHeight;
console.log("높이 : "+h)

let element1 = document.getElementById('payment'); //오른쪽 결제 창 높이 설정하여 유동적 고정 적용
element.clientHeight = h;

let myPoint = 0;


$(document).ready(function() {
    $('#_dlvy_req3').hide(); //배송요청사항 직접입력 숨기기/펼치기
    $("#_dlvy_req1").change(function(){
        let s = $('#_dlvy_req1 option:selected').val();
        if(s==4){
            $('#_dlvy_req3').show();
            $('#_dlvy_req3 input').focus();
        }else{
            $('#_dlvy_req3').hide();
        }
    });

    $('#usePoint').hide(); //사용포인트 숨기기/펼치기
    $("#_point").change(function () {
        if($(this).val() > 0) {
            $('#usePoint').show();
        } else {
            $('#usePoint').hide();
        }
    });


    //개인정보 가져오기
    getUserInfo()
    function getUserInfo() {
        $.ajax({
            url: "http://192.168.0.231:3000/getUserInfo",
            type: "get",
            data: {
                "userSeq": sessionId.userSeq
            },
            async:false,
            success: function(data) {
                console.log(data);
                $('#_userSeq').val(data.userSeq);
                $('#myPoint').text(makeComma(data.mileage)+'p');
                $('#_phone1').val(data.phone.substring(0,3));
                $('#_phone2').val(data.phone.substring(3));
                let myEmail = data.email.split('@');
                $('#_email1').val(myEmail[0]);
                $('#_email2').val(myEmail[1]);
                myPoint = data.mileage;
            },
            error: function() {
                alert('getUserInfo() error');
            }
        });
    };


    // 바로결제, 장바구니결제 마다 리스트 다르게 가져옴
    if(direct == "true" && seq != "" && itemCount != "") {
        $('#_howPayment').val(0);
        directPayment();
    } else if (direct == "false" && seq == "" && itemCount == "") {
        $('#_howPayment').val(1);
        getPaymentList();
    } else {
        alert('잘못된 접근입니다.');
        history.back();
    }


    // 바로구매용 아이템 디테일 & 선택옵션 가져오기
    function directPayment() {

        let productMaker = "";
        let productName = "";
        let productFileName = "";
        let productPrice = 0;
        let optionList = "";

        $.ajax({
            url: "http://192.168.0.231:3000/getProductDetail",
            type: "get",
            data: {
                "productSeq": seq
            },
            async: false,
            success: function(data) {
                productMaker = data.productMaker;
                productName = data.productName;
                productFileName = data.productFileName;
                if(data.productDiscount != 0) {
                    productPrice = data.productDiscount;
                } else {
                    productPrice = data.productPrice;
                }
            },
            error: function() {
                alert('directPayment() getProductDetail error');
            }
        });
        
        $.ajax({
            url: "http://192.168.0.231:3000/getProductOptionList",
            type: "get",
            data: {
                "productSeq": seq
            },
            async: false,
            success: function(data) {
                console.log("옵션리스트" +JSON.stringify(data));
                optionList = data;
            },
            error: function() {
                alert('directPayment() getProductOptionList error');
            }
        });


        let app = '<div class="row" name="_item" style="padding-bottom: 10px; border-bottom: 1px solid rgb(129, 129, 129); display: flex; align-items:center;">'
            +    '<div class="col" style="text-align: center;"><img id="itemImg" style="width: 130px; height: 130px; border-radius: 10px;" alt="" src="http://192.168.0.231:3000/upload/'+productFileName+'"></div>'
            +    '<div class="col-md-6">'
            +        '<div class="row" style="margin: 5px 0;">'
            +            '<div class="col offset-md-1">'
            +                '<p id="itemMaker" style="font-size: 12px;">'+productMaker+'</p>'
            +            '</div>'
            +        '</div>'
            +        '<div class="row" style="margin: 5px 0;">'
            +            '<div class="col offset-md-1">'
            +                '<h5 id="itemTitle" name="_itemTitle">'+productName+'</h5>'
            +            '</div>'
            +        '</div>';

            
            let optionJSON = optionList;
            let op_total_price = 0;
            for(let i = 0; i < optionJSON.length; i++) {
                for(let j = 0; j < oppArr.length; j++) {
                    if(oppArr[j].opTitle == optionJSON[i].optionTitle && oppArr[j].opContent == optionJSON[i].optionContent) {
                        app +=       '<div class="row" style="margin-top: 3px;margin-bottom: 3px;">'
                            +            '<div class="col offset-md-1" style="font-size: 13px; color: #707070;">'
                            +                '<span><b>'+optionJSON[i].optionTitle+'</b></span><span>&ensp;</span><span id="selectItem">'+optionJSON[i].optionContent+'</span><span> (+'+makeComma(optionJSON[i].optionPrice)+'원)</span>'
                            +            '</div>'
                            +        '</div>';
                        op_total_price += parseInt(optionJSON[i].optionPrice);
                    }
                }
            }
            
            
        app +=   '</div>'
            +    '<div class="col">'
            +        '<p id="itemCount">'+itemCount+'개</p>'
            +    '</div>'
            +    '<div class="col-md-2">'
            +        '<p id="itemPrice">'+makeComma(productPrice)+'원</p>'
            +    '</div>'
            +    '<div><input type="hidden" id="itemPrice_1" value="'+((productPrice+op_total_price)*itemCount)+'"></div>'
            +'</div>';
            $("#itemList").append(app);
            totalPrice();
            
            $('#_price').val(productPrice+op_total_price);
        
    }



    

    // 구매물품 장바구니 리스트 가져오기
    function getPaymentList() {
        $.ajax({
            url: "http://192.168.0.231:3000/getPaymentList",
            type: "get",
            data: {
                "cartClassify": "CT-" + sessionId.userSeq
            },
            success: function (list) {
                console.log(list);
                let app = ""
                
                if (Object.keys(list).length == 0) {
                    app += '<div style="width: 1800px; margin:50px 0px;padding:0 50px;display: flex; align-items:center;">'
                        + '<h3 style="font-size: 20px; margin-top: 10px;"><b>결제할 상품이 없습니다.</b></h3>'
                        + "</div>";
                    $("#itemList").append(app);
                } else {
                    $.each(list, function (i, val) {

                        let key = JSON.parse(val.selectOption);
                        let value = Object.keys(key);

                        app += '<div class="row" name="_item" style="padding-bottom: 10px; border-bottom: 1px solid rgb(129, 129, 129); display: flex; align-items:center;">'
                            +    '<div class="col" style="text-align: center;"><img id="itemImg" style="width: 130px; height: 130px; border-radius: 10px;" alt="" src="http://192.168.0.231:3000/upload/'+val.productFileName+'"></div>'
                            +    '<div class="col-md-6">'
                            +        '<div class="row" style="margin: 5px 0;">'
                            +            '<div class="col offset-md-1">'
                            +                '<p id="itemMaker" style="font-size: 12px;">'+val.productMaker+'</p>'
                            +            '</div>'
                            +        '</div>'
                            +        '<div class="row" style="margin: 5px 0;">'
                            +            '<div class="col offset-md-1">'
                            +                '<h5 id="itemTitle" name="_itemTitle">'+val.productName+'</h5>'
                            +            '</div>'
                            +        '</div>';

                            let optionJSON = JSON.parse(val.selectOption);
                            let op_total_price = 0;
                            for(let i=0; i<optionJSON.length; i++) {
                                app +=       '<div class="row" style="margin-top: 3px;margin-bottom: 3px;">'
                                    +            '<div class="col offset-md-1" style="font-size: 13px; color: #707070;">'
                                    +                '<span><b>'+optionJSON[i].optionTitle+'</b></span><span>&ensp;</span><span id="selectItem">'+optionJSON[i].optionContent+'</span><span> (+'+makeComma(optionJSON[i].optionPrice)+'원)</span>'
                                    +            '</div>'
                                    +        '</div>';
                                op_total_price += optionJSON[i].optionPrice;
                            }

                        app +=   '</div>'
                            +    '<div class="col">'
                            +        '<p id="itemCount">'+val.quantity+'개</p>'
                            +    '</div>'
                            +    '<div class="col-md-2">'
                            +        '<p id="itemPrice">'+makeComma(val.price)+'원</p>'
                            +    '</div>'
                            +    '<div><input type="hidden" id="itemPrice_'+(i+1)+'" value="'+((val.price+parseInt(op_total_price))*val.quantity)+'"></div>'
                            +'</div>';

                    });
                    $("#itemList").append(app);
                    totalPrice();
                };
            },
            error: function () {
                alert('getPaymentList() error');
            }
        });
    };



    $('.point_btn').click( function() { //포인트 전액사용 토글
        $(this).toggleClass('active');
        
        if($(this).hasClass('active')) {  //전액사용 버튼 활성화 시
            if(myPoint > parseInt($('#orderPrice').text().replace(/[^0-9]/g, ''))) {   // 내 포인트가 주문금액보다 많을 때,
                usePoint(parseInt($('#orderPrice').text().replace(/[^0-9]/g, '')));
            } else {
                usePoint(myPoint);
            }
            $('#usePoint').show();
        } else if($(this).removeClass('active')) {
            usePoint('empty');
            $('#usePoint').hide();
        };

        $("input:radio[name='amountType']").prop('checked',false);
    });


    let method = ''
    $('.pay_use label').click( function() { //결제수단 값,호버 
        $(this).parent().toggleClass('active')        
        $('.pay_use').not($(this).parent()).removeClass('active');

        if(!$(this).parent().hasClass('active')){
            $("input:radio[name='amountType']").prop('checked',false);
            $(this).next().prop('checked',false)
        }

        //method = $(this).parent().children('input[type="radio"]').val();
        method = $(this).next().val();
        console.log(method)
    });

    // 결제버튼 클릭
    $('.payment_btn').click(function(){

        if($('#_name').val() == '') {
            alert('이름을 입력해주세요.');
            return;       
        };

        if(!$('#cb').is(":checked")) {
            alert('약관에 동의해주세요.');
            return;   
        }


        if($('#_point').val() == '') {
            $('#_point').val(0);
        }

        let formorder1 =  decodeURIComponent($('#form_order').serialize());
        let formorder = formorder1.split('&');
        
        //모든 데이터 json형태로
        let fdata = '{'
        formorder.forEach(e => {
            let j = e.split('=');
            fdata += '"'+j[0]+'":"'
            fdata += j[1]+'",'
        });
        fdata = fdata.slice(0,-1)
        fdata += '}';
        let jdata = JSON.parse(fdata)

        if(method==''){
            alert('결제수단을 선택해주세요')
        }else{
            requestPay(method,jdata); //아임포트 결제 실행
        }
    })


    // 임시 결제버튼 클릭 (나중에 삭제)
    $('#testBtn').click(function () {

        if($('#_name').val() == '') {
            alert('이름을 입력해주세요.');
            return;       
        };

        if($('#_point').val() == '') {
            $('#_point').val(0);
        }


        let formorder1 = decodeURIComponent($('#form_order').serialize());
        let formorder = formorder1.split('&');

        //모든 데이터 json형태로
        let fdata = '{'
        formorder.forEach(e => {
            let j = e.split('=');
            fdata += '"' + j[0] + '":"'
            fdata += j[1] + '",'
        });
        fdata = fdata.slice(0, -1)
        fdata += '}';
        let jdata = JSON.parse(fdata)

        if (method == '') {
            alert('결제수단을 선택해주세요.')
        } else {
            console.log(jdata);
            let optionStr = JSON.stringify(oppArr);
            
            $.ajax({
                url: "http://192.168.0.231:3000/paymentAf",
                type: "post",
                data: jdata,
                //contentType: 'application/json',
                success: function (data) {
                    console.log(data)
                    if (data == "suc") {
                        location.href = "orderAf.html";
                    } else {
                        alert('결제실패');
                    }
                },
                error: function () {
                    alert('paymentAf error');
                }
            });

            
            
        }
    })



    // 아임포트 결제
    function requestPay(method,jdata) {
        var IMP = window.IMP; // 생략가능
        IMP.init("imp15128186"); // 가맹점 식별코드

        // IMP.request_pay(param, callback) 호출
        IMP.request_pay({ // param
            pg: "kakaopay",
            //pg: "kcp",
            pay_method: method, 
            //pay_method: "card", pay_method: "trans",
            //merchant_uid: "ORD20180131-0000011",
            buyer_email: sessionId.email,
            buyer_name: $('#_name').val(),
            //buyer_tel: sessionId.phone,
            //buyer_addr: $('#_dlvy_address1').val(),
            //buyer_postcode: "01181",
            name: $('#itemTitle').text(),
            amount: $('#sideResultPrice').text().replace(/[^0-9]/g, '')
        }, function (rsp) { // callback
            console.log(rsp)
            console.log(rsp.success)
            console.log(rsp.imp_uid)
            console.log(rsp.merchant_uid)

            if (rsp.success) {
                $.ajax({
                    url: "http://192.168.0.231:3000/paymentAf",
                    type: "post",
                    data: jdata,
                    success: function (data) {
                        console.log(data)
                        if (data == "suc") {
                            location.href = "orderAf.html";
                        } else {
                            alert('결제실패');
                        }
                    },
                    error: function () {
                        alert('paymentAf error');
                    }
                });
            } else {
                alert("결제에 실패하였습니다. 에러 내용: " + rsp.error_msg);
            }
        });
    }




    //유저 배송지 리스트 불러오기
    let addressArray = new Array();
    getAddressList();
    function getAddressList() {
        $.ajax({
            url: "http://192.168.0.231:3000/getAddressList",
            type: "post",
            data: {
                "userSeq": sessionId.userSeq
            },
            async:false,
            success: function (list) {
                console.log(list);

                let app = ""
                if (Object.keys(list).length == 0) {
                    $('#dlvy_select').children().remove();
                    app += '<div style="width: 1800px; margin:20px 0px;padding:0 20px;display: flex; align-items:center;">'
                        + '<h3 style="font-size: 15px;">저장된 배송지가 없습니다. </h3>'
                        + "</div>";
                    $("#dlvy_select").append(app);
                    $('#nav-link-select').attr('class','nav-link');
                    $('#nav-link-new').attr('class','nav-link active');
                    $('#dlvy_select').attr('class', 'tab-pane');
                    $('#dlvy_new').attr('class', 'tab-pane fade show active');
                } else {
                    $('#_dlvy_name').children().remove();
                    $.each(list, function (i, val) {
                        app += '<option id="dlvy_name_op_'+(i+1)+'" name="_dlvy_name_op" value="'+val.addressSeq+'">'+val.addressName+'</option>'
                        addressArray.push(val);
                    });
                    $('#_dlvy_name').append(app);
                    
                    if(list[0].defaultAddress != 0) {
                        showAddress(list[0].defaultAddress);
                    } else {
                        showAddress(list[0].addressSeq);
                    }
                };      
            },
            error: function () {
                alert('error');
            }
        });
    };

    // 배송지 이름 선택
    $('#_dlvy_name').change(function() {
        showAddress($(this).val());
    });

    // 주소지 입력값 넣기
    function showAddress(num) {

        let addressLength = $('option[name="_dlvy_name_op"]').length;
        
        for(let i=0; i<addressLength; i++) {
            if(addressArray[i].addressSeq == num) {
                let address = addressArray[i].address.split('///');
                $('#_dlvy_name').val(addressArray[i].addressSeq).prop("selected", true);
                $('#_dlvy_address1').val(address[0]);
                $('#_dlvy_address2').val(address[1]);
                $('#_rname').val(addressArray[i].receiveUser);
                $('#_rphone').val(addressArray[i].receivePhone);
                return;
            }

        };
    }


    //기본 배송지 설정 버튼
    $('.defalutAddress_btn').click(function() {

        let defaultAddress = $("#_dlvy_name option:selected").val();
        if (confirm("기본 배송지로 등록하시겠습니까?") == true) {
            $.ajax({
                url: "http://192.168.0.231:3000/updateDefaultAddress",
                type: "get",
                data: {
                    "userSeq": + sessionId.userSeq,
                    "defaultAddress": defaultAddress
                },
                success: function (data) {
                    console.log(data)
                    if (data == "suc") {
                        alert('기본 배송지로 설정되었습니다.');
                    } else {
                        alert('기본 배송지 설정 실패');
                    }
                    location.reload();
                },
                error: function () {
                    alert('updateDefaultAddress error');
                }
            });
        } else {
            return;
        }

    });




    //배송지 저장 버튼
    $('.dlvy_btn').click(function(){ 
        //let new_dlvy = $('#form_new_dlvy').serialize();
        let receiveTitle = $('#receiveTitle').val();
        let receiveAddress1 = $('#receiveAddress1').val();
        let receiveAddress2 = $('#receiveAddress2').val();
        let receiveUser = $('#receiveUser').val();
        let receivePhone = $('#receivePhone').val();
        if(receiveTitle == '' || receiveAddress1 == '' || receiveAddress2 == '' || receiveUser == '' || receivePhone == '') {
            alert('해당 항목을 빠짐없이 기입해주세요.');
            return;
        }
        $.ajax({
            url: "http://192.168.0.231:3000/addAddress",
            type: "post",
            data: {
                "userSeq": sessionId.userSeq,
                "addressName": receiveTitle,
                "address": receiveAddress1+"///"+receiveAddress2,
                "receiveUser": receiveUser,
                "receivePhone": receivePhone
            },
            success: function (data) {
                console.log(data);
                if(data == "suc") {
                    //console.log('주소등록완료');
                    alert('주소가 저장되었습니다.');
                    
                } else {
                    console.log('주소등록실패');
                }
                location.reload();
            },
            error: function () {
                alert('error');
            }
        });
    });


});


// 포인트 입력 이벤트
$(document).on('blur', '#_point', function () {
    $('.point_btn').toggleClass('active');
    usePoint($(this).val());
});




// 포인트 사용
function usePoint(pointCount) {
    let chkNum = /^[0-9]+$/;
    if (chkNum.test(pointCount)) {    // 숫자형식으로 들어왔는지
        if (parseInt(pointCount) > parseInt(myPoint)) {    // 내가 가진 포인트보다 많이 입력했을 때
            alert('보유 포인트보다 많습니다.');
            $('#_point').val('');
            $('#usePoint').hide();
            $('#myPoint').text(makeComma(myPoint) + 'p');
        }
        else if (parseInt(pointCount) > parseInt($('#orderPrice').text().replace(/[^0-9]/g, ''))) {  // 주문금액보다 포인트 많이 입력했을 때
            alert('주문 금액보다 많습니다.');
            $('#_point').val('');
            $('#usePoint').hide();
            $('#myPoint').text(makeComma(myPoint) + 'p');
        }
        else {
            $('#_point').val(pointCount);
            $('#myPoint').text(makeComma(myPoint - parseInt(pointCount)) + 'p');
        }
    }
    else if (pointCount == '') {
        $('#myPoint').text(makeComma(myPoint) + 'p');
    }
    else {
        $('#_point').val('');
        $('#myPoint').text(makeComma(myPoint) + 'p');
    }
    $('#sideUsePoint').text(makeComma($('#_point').val()) + ' 원');
    $('#_usePoint').text(makeComma($('#_point').val()) + 'p');
    totalPrice();
}



// 주문금액, 적립포인트 계산 및 표기
function totalPrice() {
    let itemLength = $('div[name="_item"]').length;
    let item_price = 0;
    for (let i = 1; i <= itemLength; i++) {
        item_price += parseInt($('#itemPrice_' + i).val());
        };

    $('#allItemPrice').text(makeComma(item_price));
    $('#sideTotalPrice').text(makeComma(item_price) + ' 원');
    $('#sideGetPoints').text(makeComma(item_price * 0.01) + ' p');

    if (item_price >= 50000) {
        $('#deliveryCharge').text("무료");
        $('#sideDeliveryCharge').text("무료");        
        $('#_deliveryAmount').val(0);        
        $('#orderPrice').text(makeComma(item_price) + '원');
        $('#_productAmount').val(item_price);
        $('#sideResultPrice').text(makeComma(item_price - $('#sideUsePoint').text().replace(/[^0-9]/g, '')) + '원'); //포인트 차감
        $('#sidePaymentBtn').text(makeComma(item_price - $('#sideUsePoint').text().replace(/[^0-9]/g, '')) + '원 결제하기'); //포인트 차감
        $('#_totalAmount').val(item_price - $('#sideUsePoint').text().replace(/[^0-9]/g, '')); //포인트 차감
    } else {
        $('#deliveryCharge').text("2,500원");
        $('#sideDeliveryCharge').text("2,500원");
        $('#_deliveryAmount').val(2500);
        $('#orderPrice').text(makeComma(item_price + 2500) + '원');
        $('#_productAmount').val(item_price);
        $('#sideResultPrice').text(makeComma(item_price + 2500 - $('#sideUsePoint').text().replace(/[^0-9]/g, '')) + '원'); //포인트 차감
        $('#sidePaymentBtn').text(makeComma(item_price + 2500 - $('#sideUsePoint').text().replace(/[^0-9]/g, '')) + '원 결제하기'); //포인트 차감
        $('#_totalAmount').val(item_price + 2500 - $('#sideUsePoint').text().replace(/[^0-9]/g, '')); //포인트 차감
    }
};


//카카오 주소검색 API
function execDaumPostcode() {
    new daum.Postcode({
        oncomplete: function (data) {
            var addr = data.address; // 최종 주소 변수
            // 주소 정보를 해당 필드에 넣는다.
            document.getElementById("receiveAddress1").value = addr;
        }
    }).open();
};



// 요청사항 글자수 제한 카운트 (20자)
$('#_dlvy_req2').on('keyup', function(e) {
    
    $('.textlimit').html($(this).val().length + "/20");

    if ($(this).val().length > 20) {
        $(this).val($(this).val().substring(0, 20));
        $('.textlimit').html("20/20");
    }
});



let elements_terms = $('#termsModal.modal-overlay, .modal_terms');

// 약관 모달창 버튼
$(document).on('click', '#pay_terms', function(){
    elements_terms.addClass('active');
});
$(document).on('click', '.close-modal', function(){
    elements_terms.removeClass('active');
});



/*
app.use(bodyParser.json());
// "/payments/complete"에 대한 POST 요청을 처리
app.post("/payments/complete", async (req, res) => {
    try {
        const { imp_uid, merchant_uid } = req.body; // req의 body에서 imp_uid, merchant_uid 추출
        
        // 액세스 토큰(access token) 발급 받기
        const getToken = await axios({
        url: "https://api.iamport.kr/users/getToken",
        method: "post", // POST method
        headers: { "Content-Type": "application/json" }, // "Content-Type": "application/json"
        data: {
            imp_key: "3046941560063767", // REST API키
            imp_secret: "I7HkHr84szKn1UTH0VnoHZ7Txg8moZ166IrN9zRC9CZawTRxOfWve3pMkx8Iw9PCShq2QiE0UDarw1Yl" // REST API Secret
        }
        });
        const { access_token } = getToken.data.response; // 인증 토큰
        
        // imp_uid로 아임포트 서버에서 결제 정보 조회
        const getPaymentData = await axios({
            url: 'https://api.iamport.kr/payments/${imp_uid}', // imp_uid 전달
            method: "get", // GET method
            headers: { "Authorization": access_token } // 인증 토큰 Authorization header에 추가
        });
        const paymentData = getPaymentData.data.response; // 조회한 결제 정보
        
    } catch (e) {
        res.status(400).send(e);
    }
});
*/

</script>

</html>